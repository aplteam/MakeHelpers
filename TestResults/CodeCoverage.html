<!DOCTYPE html>
<html lang="en">
<head>
<title>Coverage</title>
<meta charset="utf-8"/>
<style>
@media screen{
    html {background-color: #FFFFF0;}
body {
    font-size: 16px;
    font-family : Verdana, "Bitstream Vera Sans", "DejaVu Sans", Tahoma, Geneva, Arial, Sans-serif;
    margin: 1em;
}
th, td {padding: 5px 10px;}
th {text-align: left;}
h1, h2, h3, h4, h5, h6 {color: #424242;}
h1 {font-size: 22px;}
h2 {font-size: 18px; margin-top: 2em; margin-bottom:0.3em;}
tbody tr:nth-child(even) {background-color: #F0F0F0;}
tbody tr:nth-child(odd) {background-color: #FAFAFA;}
th {background-color: #E6E6E6;color: #424242;}
table {border: silver 1px solid; font-size: 14px;font-family: APLFont, monospace;}
code , code a {font-size: 14px; font-family: APLFont, monospace;}
code.header {
    font-size: 16px; 
    font-family: APLFont, monospace; 
    margin: 1.5em 0.5em 0 0.5em; 
    padding:0;
    display: block;
}
div.code-block {
    border: 1px silver dashed;
    background-color: #F2F2F2;
    display: block;
    margin: 0.5em 0.5em 0.5em 0.5em;
    padding: 0.5em;
}
div.code-block.missing {
    background-color: #fa605254;
}
div.code-block code {display: block; white-space: pre-wrap; margin:0; padding:0; word-wrap: break-word;}
.emphasize { font-weight: 800;}
ul li, ol li {margin: 0.7em 0.2em;}
.float-right {float:right;}
.no-underline {    text-decoration :none;}
.top-links {font-size:20px; padding-left: 0.6em;}
.align-right {text-align: right;}
#footer hr {margin-top:1.5em;}
#footer p {margin-top:5px; padding-top:0; font-size: 9px;}
@font-face {
        font-family: "APLFont";
    src:
        local("APL385 Unicode"),
        url("https://misc.aplteam.com/apl385.ttf") format("truetype");
}
.info {border: 1px silver dashed; background-color: #F2F2F2;margin: 0.5em; padding: 0.5em;}
}
@media print{@page {size: portrait}
@page {
    margin: 1cm 1cm 1cm 1.75cm;
    @bottom-right {
        content: counter(page) " / " counter(pages);
  }
}
body {
    font: 12pt "Times New Roman", Times, serif;
    line-height: 1.2;
     /* CSS3 filter, at the moment Webkit only. Prefix it for future implementations */
    -webkit-filter: grayscale(100%);
    filter: grayscale(100%); /* future-proof */
}
h1 {font-size: 18pt;}
h2 {font-size: 16pt; margin-top: 10pt; margin-bottom: 3pt;}
th, td {padding: 2pt 3pt;}
th {text-align: left;background-color: #DBDBDB;}
tbody tr:nth-child(odd) {background-color: #EDEDED;}
table {
    color-adjust: exact !important;
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
    font-size: 8pt;
    font-family: APLFont, monospace;
}
div.keep-together {break-inside: avoid; break-before:auto;}
table {border: silver 1pt solid;}
code , code a {font-size: 8pt; font-family: APLFont, monospace;}
code.header {
    font-size: 8pt;
    font-family: APLFont, monospace;
    margin: 7pt 3pt 0 10pt;
    padding:0;
    display: block;
}
div.code-block {
    border: 1pt silver dashed;
    background-color: #F2F2F2;
    display: block;
    margin: 4pt 4pt 4pt 4pt;
    padding: 4pt;
}
div.code-block code {display: block; white-space: pre-wrap; margin:0; padding:0; word-wrap: break-word;}
.emphasize { font-weight: 800;}
a {text-decoration: none;color: black;}
ul li, ol li {margin: 8pt 3pt;}
.no-print {display:none;}
.align-right {text-align: right;}
#footer hr {margin-top:1.5em;}
#footer p {margin-top:5pt; padding-top:0; font-size: 6pt;}
@font-face {
        font-family: "APLFont";
    src:
        local("APL385 Unicode"),
        url("https://misc.aplteam.com/apl385.ttf") format("truetype");
}
.info {border: 1px silver dashed; background-color: #F2F2F2;margin: 8px; padding: 8px;}
}
</style>
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/jq-3.6.0/dt-1.11.2/b-2.0.0/b-print-2.0.0/fh-3.1.9/r-2.2.9/datatables.min.css"/>
<script type="text/javascript" src="https://cdn.datatables.net/v/dt/jq-3.6.0/dt-1.11.2/b-2.0.0/b-print-2.0.0/fh-3.1.9/r-2.2.9/datatables.min.js"></script>
</head>
<body>
<h1 id="top">Coverage Report</h1>
<p>Watched: 60 fns/opr within <code>#.MakeHelpers.MakeHelpers</code></p>
<p>The test suite was executed once:</p>
<table>
<thead>
<tr><th>Executed at</th><th>APLVersion</th><th>Memory (MB)</th></tr>
</thead>
<tbody>
<tr><td>2023-08-14 10:24:16</td><td>Windows ⋄ 18.2.47418.0 ⋄ W ⋄ Development ⋄ Unicode</td><td>56</td></tr>
</tbody>
</table>
<p>Overall 84% of the testable code is covered.</p>
<p>(Comment lines, empty lines, all <code>:End</code>* lines etc. are ignored)</p>
<p>39 of the fns/opr are 100% covered.</p>
<div id="partly-covered" class="keep-together">
<table id="percent">
<thead>
<tr><th style="text-align:left;">Function/Operator</th><th style="text-align:left;">Lines not executed</th><th style="text-align:left;">Coverage</th><th style="text-align:right;">≢</th></tr>
</thead>
<tbody>
<tr class="uncovered"><td><a href="#listing_1" title="Link to listing">#.MakeHelpers.MakeHelpers.API.CR</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_2" title="Link to listing">#.MakeHelpers.MakeHelpers.API.Version</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr><td><a href="#listing_3" title="Link to listing">#.MakeHelpers.MakeHelpers.GetUserHomeFolder</a></td><td>10←≢20-24,26-29,31</td><td>44</td><td>18</td></tr>
<tr><td><a href="#listing_4" title="Link to listing">#.MakeHelpers.MakeHelpers.EstablishProjectFolder</a></td><td>5</td><td>67</td><td>3</td></tr>
<tr><td><a href="#listing_5" title="Link to listing">#.MakeHelpers.MakeHelpers.FetchLaterUserCommand</a></td><td>7←≢18-19,21,30,37,40-41</td><td>68</td><td>22</td></tr>
<tr><td><a href="#listing_6" title="Link to listing">#.MakeHelpers.MakeHelpers.MakeStandAloneRunTimeExe</a></td><td>13←≢29,42-47,49-51,56,66-67</td><td>70</td><td>44</td></tr>
<tr><td><a href="#listing_7" title="Link to listing">#.MakeHelpers.MakeHelpers.CopyTo</a></td><td>7←≢20,41-42,44-47</td><td>71</td><td>24</td></tr>
<tr><td><a href="#listing_8" title="Link to listing">#.MakeHelpers.MakeHelpers.CopyBetter</a></td><td>9←≢28-30,35,40-42,47,50</td><td>73</td><td>33</td></tr>
<tr><td><a href="#listing_9" title="Link to listing">#.MakeHelpers.MakeHelpers.Init</a></td><td>2</td><td>75</td><td>4</td></tr>
<tr><td><a href="#listing_10" title="Link to listing">#.MakeHelpers.MakeHelpers.Frame</a></td><td>8</td><td>83</td><td>6</td></tr>
<tr><td><a href="#listing_11" title="Link to listing">#.MakeHelpers.MakeHelpers.GetMyUCMDsFolder</a></td><td>13</td><td>83</td><td>6</td></tr>
<tr><td><a href="#listing_12" title="Link to listing">#.MakeHelpers.MakeHelpers.AddBuildIDtoVersionNested</a></td><td>5←≢14,33-34,36,42</td><td>85</td><td>33</td></tr>
<tr><td><a href="#listing_13" title="Link to listing">#.MakeHelpers.MakeHelpers.AddBuildIDtoVersionSimple</a></td><td>5←≢14,33-34,36,42</td><td>85</td><td>33</td></tr>
<tr><td><a href="#listing_14" title="Link to listing">#.MakeHelpers.MakeHelpers.CreateAPI</a></td><td>13←≢37-38,44-45,48,61,104,124-125,134-137</td><td>86</td><td>95</td></tr>
<tr><td><a href="#listing_15" title="Link to listing">#.MakeHelpers.MakeHelpers.CompileVersionNumberPattern</a></td><td>19, 26</td><td>87</td><td>15</td></tr>
<tr><td><a href="#listing_16" title="Link to listing">#.MakeHelpers.MakeHelpers.RecreateFolder</a></td><td>19, 23</td><td>88</td><td>17</td></tr>
<tr><td><a href="#listing_17" title="Link to listing">#.MakeHelpers.MakeHelpers.RemoveStuffButSetupExe</a></td><td>12</td><td>89</td><td>9</td></tr>
<tr><td><a href="#listing_18" title="Link to listing">#.MakeHelpers.MakeHelpers.CreateAPIfromCFG</a></td><td>22</td><td>91</td><td>11</td></tr>
<tr><td><a href="#listing_19" title="Link to listing">#.MakeHelpers.MakeHelpers.CreateStandAloneExeParms</a></td><td>14, 25</td><td>91</td><td>22</td></tr>
<tr><td><a href="#listing_20" title="Link to listing">#.MakeHelpers.MakeHelpers.CreateZipFile</a></td><td>7</td><td>92</td><td>13</td></tr>
<tr><td><a href="#listing_21" title="Link to listing">#.MakeHelpers.MakeHelpers.IncreaseBuildIDInFunction</a></td><td>39</td><td>96</td><td>24</td></tr>
<tr class="fullyCovered"><td><a href="#listing_22" title="Link to listing">#.MakeHelpers.MakeHelpers.Assert</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_23" title="Link to listing">#.MakeHelpers.MakeHelpers.Box</a></td><td></td><td>100</td><td>7</td></tr>
<tr class="fullyCovered"><td><a href="#listing_24" title="Link to listing">#.MakeHelpers.MakeHelpers.CR</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_25" title="Link to listing">#.MakeHelpers.MakeHelpers.ConvertMarkdownToHtml5</a></td><td></td><td>100</td><td>13</td></tr>
<tr class="fullyCovered"><td><a href="#listing_26" title="Link to listing">#.MakeHelpers.MakeHelpers.DropBuildNumber</a></td><td></td><td>100</td><td>5</td></tr>
<tr class="fullyCovered"><td><a href="#listing_27" title="Link to listing">#.MakeHelpers.MakeHelpers.GetPackageCfg</a></td><td></td><td>100</td><td>5</td></tr>
<tr class="fullyCovered"><td><a href="#listing_28" title="Link to listing">#.MakeHelpers.MakeHelpers.GetProjectCfg</a></td><td></td><td>100</td><td>5</td></tr>
<tr class="fullyCovered"><td><a href="#listing_29" title="Link to listing">#.MakeHelpers.MakeHelpers.Pause</a></td><td></td><td>100</td><td>3</td></tr>
<tr class="fullyCovered"><td><a href="#listing_30" title="Link to listing">#.MakeHelpers.MakeHelpers.Public</a></td><td></td><td>100</td><td>27</td></tr>
<tr class="fullyCovered"><td><a href="#listing_31" title="Link to listing">#.MakeHelpers.MakeHelpers.PutPackageCfg</a></td><td></td><td>100</td><td>3</td></tr>
<tr class="fullyCovered"><td><a href="#listing_32" title="Link to listing">#.MakeHelpers.MakeHelpers.Select</a></td><td></td><td>100</td><td>2</td></tr>
<tr class="fullyCovered"><td><a href="#listing_33" title="Link to listing">#.MakeHelpers.MakeHelpers.SplitVersionFromBuildNumber</a></td><td></td><td>100</td><td>8</td></tr>
<tr class="fullyCovered"><td><a href="#listing_34" title="Link to listing">#.MakeHelpers.MakeHelpers.UpdateVersionNumberInInno_ISS</a></td><td></td><td>100</td><td>10</td></tr>
<tr class="fullyCovered"><td><a href="#listing_35" title="Link to listing">#.MakeHelpers.MakeHelpers.Version</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_36" title="Link to listing">#.MakeHelpers.MakeHelpers.YesOrNo</a></td><td></td><td>100</td><td>2</td></tr>
<tr class="fullyCovered"><td><a href="#listing_37" title="Link to listing">#.MakeHelpers.MakeHelpers.API.CompileVersionNumberPattern</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_38" title="Link to listing">#.MakeHelpers.MakeHelpers.API.ConvertMarkdownToHtml5</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_39" title="Link to listing">#.MakeHelpers.MakeHelpers.API.CopyBetter</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_40" title="Link to listing">#.MakeHelpers.MakeHelpers.API.CopyTo</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_41" title="Link to listing">#.MakeHelpers.MakeHelpers.API.CreateAPI</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_42" title="Link to listing">#.MakeHelpers.MakeHelpers.API.CreateAPIfromCFG</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_43" title="Link to listing">#.MakeHelpers.MakeHelpers.API.CreateStandAloneExeParms</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_44" title="Link to listing">#.MakeHelpers.MakeHelpers.API.CreateZipFile</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_45" title="Link to listing">#.MakeHelpers.MakeHelpers.API.DropBuildNumber</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_46" title="Link to listing">#.MakeHelpers.MakeHelpers.API.FetchLaterUserCommand</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_47" title="Link to listing">#.MakeHelpers.MakeHelpers.API.GetMyUCMDsFolder</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_48" title="Link to listing">#.MakeHelpers.MakeHelpers.API.GetPackageCfg</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_49" title="Link to listing">#.MakeHelpers.MakeHelpers.API.GetProjectCfg</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_50" title="Link to listing">#.MakeHelpers.MakeHelpers.API.GetUserHomeFolder</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_51" title="Link to listing">#.MakeHelpers.MakeHelpers.API.IncreaseBuildIDInFunction</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_52" title="Link to listing">#.MakeHelpers.MakeHelpers.API.MakeStandAloneRunTimeExe</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_53" title="Link to listing">#.MakeHelpers.MakeHelpers.API.Pause</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_54" title="Link to listing">#.MakeHelpers.MakeHelpers.API.PutPackageCfg</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_55" title="Link to listing">#.MakeHelpers.MakeHelpers.API.RecreateFolder</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_56" title="Link to listing">#.MakeHelpers.MakeHelpers.API.RemoveStuffButSetupExe</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_57" title="Link to listing">#.MakeHelpers.MakeHelpers.API.Select</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_58" title="Link to listing">#.MakeHelpers.MakeHelpers.API.SplitVersionFromBuildNumber</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_59" title="Link to listing">#.MakeHelpers.MakeHelpers.API.UpdateVersionNumberInInno_ISS</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_60" title="Link to listing">#.MakeHelpers.MakeHelpers.API.YesOrNo</a></td><td></td><td>100</td><td>0</td></tr>
</tbody>
</table>
</div>
<script>
$(document).ready(function() {
    var oTable;
    oTable = $("#percent").DataTable( {
        paging:   false,
        ordering: true,
        info:     true,
        fixedHeader: true,
        order: [2,"asc"],
        dom: "Bft",
        drawCallback: function( settings ) {
             var api = this.api();
             $('.header[id^="listing_"]').next().addBack().css("display","none");
             api.rows( {page:"current"} ).data().each(function(data){
              id = data[0];
              id = id.match(/"(\#.*?)"/);
              if (id){$(id[1]).next().addBack().css("display","block");}
             })
        },      
        buttons: [
        {
            text: "Partly covered (19)",
            titleAttr: "50%",
            className: "active",
            action: function ( e, dt, node, config ) {
                var text = this.text();
                var search = "^(?!(0%|100%)).*";
                oTable.column(2)
                    .search(search,true,false,false)
                    .draw();
                $(".dt-buttons button").removeClass("active");
                this.active( true );
            }
        },
        {
            text: "Uncovered (2)",
            titleAttr: "0%",
            className: "active",
            action: function ( e, dt, node, config ) {
                var text = this.text();
                var search = "^0%";
                oTable.column(2)
                    .search(search,true,false,false)
                    .draw();
                $(".dt-buttons button").removeClass("active");
                this.active( true );
            }
        },
        {
            text: "Fully covered (39)",
            titleAttr: "100%",
            className: "active",
            action: function ( e, dt, node, config ) {
                var text = this.text();
                var search = "100%";
                oTable.column(2)
                    .search(search,true,false,false)
                    .draw();
                $(".dt-buttons button").removeClass("active");
                this.active( true );
            }
        },
        {
            text: "All (60)",
            titleAttr: "all",
            className: "active",
            action: function ( e, dt, node, config ) {
                var text = this.text();
                var search = ".";
                oTable.column(2)
                    .search(search,true,false,false)
                    .draw();
                $(".dt-buttons button").removeClass("active");
                this.active( true );
            }
        },
    ],
 
        columnDefs: [
            {className: "align-right", targets: [2,3]
            },
            {
                render: function ( data, type, row, meta ) {
                            return data+"%" ;        
                        },
                targets: 2
            }
        ]             
    } );
    oTable.button(0).trigger();

} );    
</script>
<h2>Listings</h2>
<code class="header" id="listing_1">#.MakeHelpers.MakeHelpers.API.CR &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←CR</code>
<code class="emphasize">→[1]  r←##.CR</code>
</div>
<code class="header" id="listing_2">#.MakeHelpers.MakeHelpers.API.Version &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←Version</code>
<code class="emphasize">→[1]  r←##.Version</code>
</div>
<code class="header" id="listing_3">#.MakeHelpers.MakeHelpers.GetUserHomeFolder &mdash; 44%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←{os}GetUserHomeFolder add</code>
<code> [1]  ⍝ Returns standard path for any user-specific data.\\</code>
<code> [2]  ⍝ Works on all platforms but returns different results.\\</code>
<code> [3]  ⍝ `⍵`, if not empty, is added to the resulting path.\\</code>
<code> [4]  ⍝ Under Windows typically:\\</code>
<code> [5]  ⍝ * ``%APPDATA%\Tatin'     ←→ GetUserHomeFolder ''`</code>
<code> [6]  ⍝ * ``%APPDATA%\Tatin\foo' ←→ GetUserHomeFolder 'foo'`\\</code>
<code> [7]  ⍝ On non-Windows platforms:\\</code>
<code> [8]  ⍝ * `'/home/{⎕AN}/Tatin'     ←→ GetUserHomeFolder ''`</code>
<code> [9]  ⍝ * `'/home/{⎕AN}/Tatin/foo' ←→ GetUserHomeFolder 'foo'`\\</code>
<code> [10] ⍝ `⍺` is optional and only specified by test cases: used to simulate different versions of the operating system.</code>
<code> [11]  os←{0&lt;⎕NC ⍵:⍎⍵ ⋄ A.GetOperatingSystem''}'os'</code>
<code> [12]  add←{(((~'/\'∊⍨⊃⍵)∧0≠≢⍵)/'/'),⍵}add</code>
<code> [13]  (p v)←2↑os</code>
<code> [14]  (w l)←'WL'∊''⍴p</code>
<code> [15]  d←'/Tatin'</code>
<code> [16]  (h lad)←2 ⎕NQ'.' 'GetEnvironment'('HOME' 'APPDATA')</code>
<code> [17]  :If w</code>
<code> [18]      r←F.ExpandPath lad,d,add               ⍝ windows</code>
<code> [19]  :Else</code>
<code class="emphasize">→[20]      as←'/Library/Application Support'      ⍝ special mac folder</code>
<code class="emphasize">→[21]      :If l∧0≠≢h</code>
<code class="emphasize">→[22]          r←F.ExpandPath h,d,add             ⍝ linux</code>
<code class="emphasize">→[23]      :ElseIf 0≠≢h</code>
<code class="emphasize">→[24]          r←F.ExpandPath h,as,d,add          ⍝ mac</code>
<code> [25]      :Else</code>
<code class="emphasize">→[26]          u←⊃~∘∊⍨2 ⎕NQ'.' 'GetEnvironment'('LOGNAME' 'USER' 'LNAME' 'USERNAME')</code>
<code class="emphasize">→[27]          'No user found?!'Assert 0&lt;≢u</code>
<code class="emphasize">→[28]          :If l</code>
<code class="emphasize">→[29]              r←'/home/',u,d,add             ⍝ linux</code>
<code> [30]          :Else</code>
<code class="emphasize">→[31]              r←'/Users/',u,as,d,add         ⍝ mac</code>
<code> [32]          :EndIf</code>
<code> [33]      :EndIf</code>
<code> [34]  :EndIf</code>
<code> [35] ⍝Done</code>
</div>
<code class="header" id="listing_4">#.MakeHelpers.MakeHelpers.EstablishProjectFolder &mdash; 67%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> path←EstablishProjectFolder ref</code>
<code> [1] ⍝ `ref` must be a reference pointing to a namespace expected to be managed by Cider.</code>
<code> [2]  :If 0&lt;ref.⎕NC'CiderConfig'</code>
<code> [3]      path←ref.CiderConfig.HOME</code>
<code> [4]  :Else</code>
<code class="emphasize">→[5]      'Not managed by Cider'⎕SIGNAL 11</code>
<code> [6]  :EndIf</code>
</div>
<code class="header" id="listing_5">#.MakeHelpers.MakeHelpers.FetchLaterUserCommand &mdash; 68%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←{batch}FetchLaterUserCommand(cfg C path)</code>
<code> [1]  ⍝ Check if the user command in `path` (if any) is identical with the one in the project. If they are</code>
<code> [2]  ⍝ not identical the user is asked whether she wants to copy the later version over, unless `batch` is</code>
<code> [3]  ⍝ 1, in which case the copy operation is carried out silently.</code>
<code> [4]  ⍝ * `C` is a namespace with a Cider configuration</code>
<code> [5]  ⍝ * `path` is something like the Dyalog MyUCMDs/ folder, though `[myucmds]` is understood and replaced\\</code>
<code> [6]  ⍝   You only need to add the name of the sub folder if it is not identical with the user command name</code>
<code> [7]  ⍝ * `batch`, if specified, must be a boolean indicating the function is called as part of an</code>
<code> [8]  ⍝   automated "make" process, meaning that no user is available in front of the monitor\\</code>
<code> [9]  ⍝ Returns 0 for "no action", 1 for the file in `path` winning the day and 2 otherwise.\\</code>
<code> [10] ⍝ If the script is copied over from `path` and batch←0 then the user is warned that the WS is</code>
<code> [11] ⍝ out of sync in respect to the user command script.\\</code>
<code> [12] ⍝ Because we can savely assume that there should be such a folder hosting such a script, we ask the user</code>
<code> [13] ⍝ whether she wants to carry on anyway if we can't find it.</code>
<code> [14]  r←0</code>
<code> [15]  batch←{0&lt;⎕NC ⍵:⍎⍵ ⋄ 0}'batch'</code>
<code> [16]  :If 0&lt;≢uc←{⊃,/1↓⎕NPARTS ⍵}cfg.userCommandScript</code>
<code> [17]      :If '[myucmds]'{⍺≡⎕C(≢⍺)↑⍵}path</code>
<code class="emphasize">→[18]          :If 0=≢path2←{⍵↓⍨⍵⍳']'}path</code>
<code class="emphasize">→[19]              path2←cfg.name</code>
<code> [20]          :EndIf</code>
<code class="emphasize">→[21]          path←F.AddTrailingSep 1 F.NormalizePath(GetMyUCMDsFolder''),'/',path2</code>
<code> [22]      :EndIf</code>
<code> [23]      fn1←(FilesAndDirs.AddTrailingSep path),uc</code>
<code> [24]      :If F.IsFile fn1</code>
<code> [25]          caption1←path</code>
<code> [26]          caption2←C.CIDER.source,'/'</code>
<code> [27]          buff←{⍵↑⍨(≢⍵)⌊⌊/⍵⍳'/\'}cfg.source</code>
<code> [28]          fn2←C.HOME,'/',buff,'/',uc</code>
<code> [29]          :If cfg.source≢buff</code>
<code class="emphasize">→[30]              (uc,' not found in neither ',path,cfg.name,' nor ',buff)Assert ⎕NEXISTS fn2</code>
<code> [31]          :Else</code>
<code> [32]              (uc,' not found in ',cfg.source)Assert ⎕NEXISTS fn2</code>
<code> [33]          :EndIf</code>
<code> [34]          caption2←buff</code>
<code> [35]          r←batch CopyBetter fn1 fn2 caption1 caption2</code>
<code> [36]      :Else</code>
<code class="emphasize">→[37]          'Interrupted on behalf of the user'Assert CommTools.YesOrNo'Could not locate the user command script ',fn1,'; carry on?'</code>
<code> [38]      :EndIf</code>
<code> [39]      :If ~batch</code>
<code class="emphasize">→[40]      :AndIf r=¯1</code>
<code class="emphasize">→[41]          Frame'&lt;',uc,'&gt; on disk is now out of sync with the WS!'</code>
<code> [42]      :EndIf</code>
<code> [43]  :EndIf</code>
<code> [44] ⍝Done</code>
</div>
<code class="header" id="listing_6">#.MakeHelpers.MakeHelpers.MakeStandAloneRunTimeExe &mdash; 70%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {rc}←{testFlag}MakeStandAloneRunTimeExe p</code>
<code> [1]  ⍝ Attempts to create a stand-alone EXE from the current workspace.\\</code>
<code> [2]  ⍝ This is a Windows-ony helper.\\</code>
<code> [3]  ⍝ `p` is a parameter space, typically created by calling `CreateStandAloneExeParms`.\\</code>
<code> [4]  ⍝ `←` is what the `Bind` method returns or `⍬` in case something goes wrong without throwing an error.\\</code>
<code> [5]  ⍝ Because the creation of a stand-alone EXE quite often fails for no apparent reason this function</code>
<code> [6]  ⍝ tries up to 10 times. However, the most common reason for a failure is that the EXE</code>
<code> [7]  ⍝ is actually running and therefore cannot be overwritten. In case "Autostatus" in the "Options" of the</code>
<code> [8]  ⍝ session is ticked the error message "Could not copy stub exe" would be displayed. \\</code>
<code> [9]  ⍝ This function will check for this and tell the user. (There is an REF 13574 to make this accessible via `⎕DMX`; 2019-11)\\</code>
<code> [10] ⍝ When the option `testFlag` is `1` then only **one** attempt is made to create the EXE, and</code>
<code> [11] ⍝ in case of the aformentioned problem no intercation with the user is attempted, and `¯1` is returned.</code>
<code> [12] ⍝ Otherwise a 1 is returned.\\</code>
<code> [13]  rc←¯1</code>
<code> [14]  testFlag←{0&lt;⎕NC ⍵:⍎⍵ ⋄ 0}'testFlag'</code>
<code> [15]  'Right argument is not a parameter space'⎕SIGNAL 11/⍨9.1≠⎕NC⊂,'p'</code>
<code> [16]  'Parameter space does not provide a filename'⎕SIGNAL 11/⍨0=p.⎕NC'Filename'</code>
<code> [17]  '"Filename" is empty'⎕SIGNAL 11/⍨0=≢p.Filename</code>
<code> [18]  counter←success←0</code>
<code> [19]  RUNTIME←8×p.RunTime</code>
<code> [20]  details←0 2⍴''</code>
<code> [21]  details⍪←'FileDescription'p.FileDescription</code>
<code> [22]  details⍪←'ProductVersion'p.ProductVersion</code>
<code> [23]  details⍪←'CompanyName'p.CompanyName           ⍝ Not shown by Windows Explorer anyway</code>
<code> [24]  details⍪←'Comments'p.Comments                 ⍝ Not shown by Windows Explorer anyway</code>
<code> [25]  details⍪←'ProductName'p.ProjectName</code>
<code> [26]  :If 0&lt;(⍎'#.',p.ProjectName).⎕NC'Version'</code>
<code> [27]      version←#.⍎p.ProjectName,'.Version'</code>
<code> [28]      :If 1&lt;≡version</code>
<code class="emphasize">→[29]          details⍪←'FileVersion'({⍵↑⍨¯1+⍵⍳'+'}2⊃version)</code>
<code> [30]      :Else</code>
<code> [31]          details⍪←'FileVersion'({⍵↑⍨¯1+⍵⍳'+'}version)</code>
<code> [32]      :EndIf</code>
<code> [33]  :EndIf</code>
<code> [34]  details⍪←'LegalCopyright'('See https://github.com/aplteam/',p.ProjectName)</code>
<code> [35]  tempFile←'exe'F.GetTempFilename2 2⊃⎕NPARTS p.Filename</code>
<code> [36]  :Repeat</code>
<code> [37]      :Trap 11</code>
<code> [38]          rc←2 #.⎕NQ'#' 'Bind'tempFile'StandaloneNativeExe'RUNTIME p.Resource p.Icon p.Commandline details</code>
<code> [39]          '"Bind" failed'Assert 1=rc</code>
<code> [40]          success←1</code>
<code> [41]      :Else</code>
<code class="emphasize">→[42]          :Trap 0</code>
<code class="emphasize">→[43]              sw←⎕SE.⎕WG'StatusWindow'</code>
<code class="emphasize">→[44]              :If 0&lt;≢sw.⎕WG'Text'</code>
<code class="emphasize">→[45]                  :If ∨/'Could not copy stub exe'⍷⊃⌽{⍵/⍨0&lt;≢¨⍵}sw.⎕WG'Text'</code>
<code class="emphasize">→[46]                      :If testFlag</code>
<code class="emphasize">→[47]                          rc←¯1</code>
<code> [48]                      :Else</code>
<code class="emphasize">→[49]                          ⎕←'It seeems that the EXE that should be created is currently running - that cannot work!'</code>
<code class="emphasize">→[50]                          ⎕←'Please make sure the EXE (',p.Filename,') is not running any more and then press &lt;enter&gt;.'</code>
<code class="emphasize">→[51]                          {}⍞</code>
<code> [52]                      :EndIf</code>
<code> [53]                  :EndIf</code>
<code> [54]              :EndIf</code>
<code> [55]          :EndTrap</code>
<code class="emphasize">→[56]          ⎕DL 0.25</code>
<code> [57]      :EndTrap</code>
<code> [58]  :Until testFlag∨success∨10&lt;counter←counter+1</code>
<code> [59]  'Creating stand-alone EXE failed even after 10 attempts'Assert success</code>
<code> [60]  ⎕DL 0.1</code>
<code> [61]  :Trap 19 22</code>
<code> [62]      1 ⎕NDELETE p.Filename        ⍝ Paranoia</code>
<code> [63]      ⎕DL 0.2</code>
<code> [64]      p.Filename ⎕NMOVE tempFile</code>
<code> [65]  :Else</code>
<code class="emphasize">→[66]      :Trap 0 ⋄ 1 ⎕NDELETE tempFile ⋄ :EndTrap</code>
<code class="emphasize">→[67]      rc←¯1</code>
<code> [68]  :EndTrap</code>
<code> [69] ⍝Done</code>
</div>
<code class="header" id="listing_7">#.MakeHelpers.MakeHelpers.CopyTo &mdash; 71%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←x CopyTo y</code>
<code> [1]  ⍝ Copy `x` to `y`.\\</code>
<code> [2]  ⍝ `x` can be one of:</code>
<code> [3]  ⍝ * A nested vector of character vectors, each being a filename</code>
<code> [4]  ⍝ * A simple string representing either a filename or a folder</code>
<code> [5]  ⍝   * A folder is copied over together with its contents</code>
<code> [6]  ⍝   * A simple file is copied over as such\\</code>
<code> [7]  ⍝ `y` must be a folder in case `x` specified a folder or is a list of files.</code>
<code> [8]  ⍝ Otherwise it must be a filename.\\</code>
<code> [9]  ⍝ Note that if the "name" and/or the "extension" part of `x` contain either "*" or "?"</code>
<code> [10] ⍝ then the matching files and folders are copied.\\</code>
<code> [11] ⍝ Throws an error in case something went wrong.\\</code>
<code> [12] ⍝ Takes ace of missing folder, does not care whether files already exist and preserves attributes.\\</code>
<code> [13] ⍝ Returns always a 0.</code>
<code> [14]  r←0</code>
<code> [15]  :If 2&gt;|≡x</code>
<code> [16]      (x y)←F.NormalizePath¨x y</code>
<code> [17]      :If F.IsFile x</code>
<code> [18]      :AndIf F.IsDir y</code>
<code> [19]      :AndIf ~(¯1↑y)∊'/\'</code>
<code class="emphasize">→[20]          'Cannot copy file over folder'⎕SIGNAL 11</code>
<code> [21]      :EndIf</code>
<code> [22]      :If F.IsFile x</code>
<code> [23]      :AndIf (¯1↑y)∊'/\'</code>
<code> [24]          y,←⊃{⍺,⍵}/1↓⎕NPARTS x</code>
<code> [25]      :Else</code>
<code> [26]          y↓⍨←-∨/'/\'∊⍨¯1↑y</code>
<code> [27]      :EndIf</code>
<code> [28]      :If F.IsFile x</code>
<code> [29]          :If ~F.Exists y</code>
<code> [30]              'Create!'F.CheckPath(1⊃⎕NPARTS y)</code>
<code> [31]          :EndIf</code>
<code> [32]      :Else</code>
<code> [33]          F.MkDir y</code>
<code> [34]      :EndIf</code>
<code> [35]      :If ∨/'?*'∊⊃,/1↓⎕NPARTS x</code>
<code> [36]          y ⎕NCOPY⍠('IfExists' 'Replace')('Wildcard' 1)('PreserveAttributes' 1)⊣x</code>
<code> [37]      :Else</code>
<code> [38]          y ⎕NCOPY⍠('IfExists' 'Replace')('PreserveAttributes' 1)⊣x</code>
<code> [39]      :EndIf</code>
<code> [40]  :Else</code>
<code class="emphasize">→[41]      :If ~(¯1↑y)∊'/\'</code>
<code class="emphasize">→[42]          'Cannot copy file over folder'Assert 0=F.IsDir y</code>
<code> [43]      :EndIf</code>
<code class="emphasize">→[44]      y←F.NormalizePath y</code>
<code class="emphasize">→[45]      x←F.NormalizePath¨x</code>
<code class="emphasize">→[46]      'Could not create target directory'Assert'Create!'F.CheckPath y</code>
<code class="emphasize">→[47]      {}y ⎕NCOPY⍠('IfExists' 'Replace')⊣x</code>
<code> [48]  :EndIf</code>
<code> [49] ⍝Done</code>
</div>
<code class="header" id="listing_8">#.MakeHelpers.MakeHelpers.CopyBetter &mdash; 73%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←{quietFlag}CopyBetter y</code>
<code> [1]  ⍝ Compare two different files and asks the user for copying over the "better" one.\\</code>
<code> [2]  ⍝ Both files are checked for existence. If one or both are missing no action is taken.\\</code>
<code> [3]  ⍝ `⍵` must be a vector of length 2 or 4. The first two are mandatory: the two filenames.\\</code>
<code> [4]  ⍝ Optionally you may also specify two captions used when the user is questioned.</code>
<code> [5]  ⍝ The captions default to the filenames.\\</code>
<code> [6]  ⍝ `⍺` defaults to 0 but may be 1 in which case the user will not be prompted (tests and automated processes).\\</code>
<code> [7]  ⍝ Returns one of:</code>
<code> [8]  ⍝ *  0 for "no action required" (because the timestamps match)</code>
<code> [9]  ⍝ * ¯1 for "cancelled by user"  (user refused confirmation)</code>
<code> [10] ⍝ *  1 for `file1` winning the day</code>
<code> [11] ⍝ *  2 for `file2` winning the day</code>
<code> [12]  r←0</code>
<code> [13]  quietFlag←{0&lt;⎕NC ⍵:⍎⍵ ⋄ 0}'quietFlag'</code>
<code> [14]  y←⊆y</code>
<code> [15]  '⍵ must have a length of 2 or 4'⎕SIGNAL 11/⍨~(≢y)∊2 4</code>
<code> [16]  (file1 file2 caption1 caption2)←4↑y,y</code>
<code> [17]  :If 0∊b←⎕NEXISTS¨file1 file2</code>
<code> [18]      ('Does not exist: ',⊃{⍺,',',⍵}/(~b)/file1 file2)Assert 0</code>
<code> [19]  :EndIf</code>
<code> [20]  'You cannot copy a file onto itself'Assert file1≢file2</code>
<code> [21]  :If ≢/{⊃F.NGET ⍵}¨file1 file2</code>
<code> [22]      (ts1 ts2)←F.GetModifiedDate¨file1 file2</code>
<code> [23]      (ts1_ ts2_)←F.DateToReal¨ts1 ts2</code>
<code> [24]      sep←⎕UCS 10</code>
<code> [25]      :If ts1_&gt;ts2_</code>
<code> [26]          cancelled←0</code>
<code> [27]          :If quietFlag</code>
<code class="emphasize">→[28]              msg←'Copy newer version in',sep,('  ',caption1),sep,'from ',A.FormatDateTime ts1</code>
<code class="emphasize">→[29]              msg,←sep,'over',sep,('  ',caption2),sep,'from ',(A.FormatDateTime ts2),'  ?'</code>
<code class="emphasize">→[30]          :OrIf ~cancelled←~YesOrNo msg</code>
<code> [31]              file1 CopyTo file2</code>
<code> [32]              r←1</code>
<code> [33]          :EndIf</code>
<code> [34]          :If cancelled</code>
<code class="emphasize">→[35]              r←¯1</code>
<code> [36]          :EndIf</code>
<code> [37]      :ElseIf ts1_&lt;ts2_</code>
<code> [38]          cancelled←0</code>
<code> [39]          :If quietFlag</code>
<code class="emphasize">→[40]              msg←'Copy newer version in',sep,('  ',caption2),sep,'from ',A.FormatDateTime ts2</code>
<code class="emphasize">→[41]              msg,←sep,'over',sep,('  ',caption1),sep,'from ',(A.FormatDateTime ts1),'  ?'</code>
<code class="emphasize">→[42]          :OrIf ~cancelled←~YesOrNo msg</code>
<code> [43]              file2 CopyTo file1</code>
<code> [44]              r←2</code>
<code> [45]          :EndIf</code>
<code> [46]          :If cancelled</code>
<code class="emphasize">→[47]              r←¯1</code>
<code> [48]          :EndIf</code>
<code> [49]      :Else</code>
<code class="emphasize">→[50]          'The two files share a timestamp but differ in content?!'Assert≡/{⊃F.NGET ⍵ 1}¨file1 file2</code>
<code> [51]      :EndIf</code>
<code> [52]  :EndIf</code>
<code> [53] ⍝Done</code>
</div>
<code class="header" id="listing_9">#.MakeHelpers.MakeHelpers.Init &mdash; 75%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> Init</code>
<code> [1]  :If '⎕SE._tatin.'{⍺≡(≢⍺)↑⍵}⍕⎕THIS    ⍝ Then it's not a project, it's loaded as a package...</code>
<code class="emphasize">→[2]      ⎕EX'MakeHelpers_UC'              ⍝ ... and in that case we do not need the user command script in the WS</code>
<code> [3]  :EndIf</code>
<code> [4]  A←APLTreeUtils2</code>
<code> [5]  F←FilesAndDirs</code>
<code> [6] ⍝Done</code>
</div>
<code class="header" id="listing_10">#.MakeHelpers.MakeHelpers.Frame &mdash; 83%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←Frame y</code>
<code> [1]  ⍝ Surrounds y by a frame.</code>
<code> [2]  ⍝ `y` can be one of:</code>
<code> [3]  ⍝ * Simple char vector</code>
<code> [4]  ⍝ * Simple char matrix</code>
<code> [5]  ⍝ * Nested vector of simple char vectors</code>
<code> [6]  ⍝ `←` is always a simple matrix</code>
<code> [7]   :If 1&lt;|≡y</code>
<code class="emphasize">→[8]       y←↑y</code>
<code> [9]   :EndIf</code>
<code> [10]  :If 2≠⍴⍴y</code>
<code> [11]      y←,[0.5]y</code>
<code> [12]  :EndIf</code>
<code> [13]  r←'⌹',('⌹'⍪y⍪'⌹'),'⌹'</code>
<code> [14]  r←Box r</code>
</div>
<code class="header" id="listing_11">#.MakeHelpers.MakeHelpers.GetMyUCMDsFolder &mdash; 83%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←{os}GetMyUCMDsFolder add</code>
<code> [1]  ⍝ Returns the standard path for Dyalog's `MyUCMDs\` folder.\\</code>
<code> [2]  ⍝ Works on all platforms but returns different results.\\</code>
<code> [3]  ⍝ Under Windows typically:\\</code>
<code> [4]  ⍝ `C:\Users\{⎕AN}\Documents\MyUCMDs\Foo'  ←→ GetMyUCMDsFolder 'Foo'`\\</code>
<code> [5]  ⍝ `⍺` is optional and only specified by test cases: simulating different versions of the operating system.</code>
<code> [6]   :If 0=⎕NC'os'</code>
<code> [7]       os←A.GetOperatingSystem''</code>
<code> [8]   :EndIf</code>
<code> [9]   add←{(((~'/\'∊⍨⊃⍵)∧0≠≢⍵)/'/'),⍵}add</code>
<code> [10]  :If 'Win'≡os</code>
<code> [11]      r←F.ExpandPath(2⊃4070⌶0),'\..\MyUCMDs',add</code>
<code> [12]  :Else</code>
<code class="emphasize">→[13]      r←(2 ⎕NQ'.' 'GetEnvironment' 'Home'),'/MyUCMDs',add</code>
<code> [14]  :EndIf</code>
<code> [15]  ⍝Done</code>
</div>
<code class="header" id="listing_12">#.MakeHelpers.MakeHelpers.AddBuildIDtoVersionNested &mdash; 85%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {body}←x AddBuildIDtoVersionNested buildID</code>
<code> [1]   ⍝ `x` can either be a reference pointing to a class, an Interface or a scripted namespace</code>
<code> [2]   ⍝ or the name of a function in an ordinary namespace.\\</code>
<code> [3]   ⍝ Generally `AddBuildIDtoVersionNested` executes the `Version` function (⍺) if there is any.</code>
<code> [4]   ⍝ It then either adds the build ID (⍵, an integer) if there was not any yet</code>
<code> [5]   ⍝ or replaces it by the built ID given.</code>
<code> [6]   :If ¯1≡×⎕NC⊂⍕x                                  ⍝ Member of a class?</code>
<code> [7]   :OrIf {0::0 ⋄ 1⊣⎕SRC⍎⍵}¯1↓1⊃'.'A.SplitPath x    ⍝ Function in a scripted namespace?</code>
<code> [8]       x←⍎⊃{⍺,'.',⍵}/¯1↓'.'(≠⊆⊢)x</code>
<code> [9]   :EndIf</code>
<code> [10]  :If flag←0=≡x</code>
<code> [11]      body←⎕SRC ref←x</code>
<code> [12]      result←2⊃ref.Version</code>
<code> [13]      :If 0=≢buff←'∇ *[A-Za-z]←Version'⎕S 0 1 2⍠('Mode' 'L')('Greedy' 0)('IC' 1)⊣body</code>
<code class="emphasize">→[14]          'Could not find function `Version`'⎕SIGNAL 6</code>
<code> [15]      :EndIf</code>
<code> [16]      (offset length row)←⊃buff   ⍝ There might be other `Version` functions but the first one is "ours"</code>
<code> [17]      varsName←{{⍵↑⍨¯1+⍵⍳'←'}' '~⍨⍵↓⍨⍵⍳'∇'}(row+1)⊃body</code>
<code> [18]      row+←2+⊃('\b',varsName,'←')⎕S 2⊣(1+row)↓body</code>
<code> [19]      version←{⍵↑⍨¯1+⍵⍳''''}{{⌽⍵/⍨4&gt;+\''''=⍵}⌽⍵}row⊃body</code>
<code> [20]  :Else</code>
<code> [21]      ref←⍎¯1↓⊃'.'A.SplitPath fnsname←x</code>
<code> [22]      body←⎕NR fnsname</code>
<code> [23]      version←2⊃⍎fnsname</code>
<code> [24]      row←⊃¯1↑⍸∨/¨version∘⍷¨body</code>
<code> [25]  :EndIf</code>
<code> [26]  :If 2='.'+.=version</code>
<code> [27]      :If '+'∊version</code>
<code> [28]          version2←(version↑⍨version⍳'+'),⍕buildID</code>
<code> [29]      :Else</code>
<code> [30]          version2←version,'+',⍕buildID</code>
<code> [31]      :EndIf</code>
<code> [32]  :Else</code>
<code class="emphasize">→[33]      :If 2&lt;'.'+.=version</code>
<code class="emphasize">→[34]          version[3⊃⍸'.'=version]←'+'</code>
<code> [35]      :EndIf</code>
<code class="emphasize">→[36]      version2←({⍵↑⍨¯1+⍵⍳'+'}version),'+',⍕buildID</code>
<code> [37]  :EndIf</code>
<code> [38]  version←⊃,/(⊂'\.')@(⍸'.'=version)⊣version</code>
<code> [39]  version←⊃,/(⊂'\+')@(⍸'+'=version)⊣version</code>
<code> [40]  line←row⊃body</code>
<code> [41]  :If 2&lt;'.'+.=line</code>
<code class="emphasize">→[42]      line[3⊃⍸'.'=line]←'+'</code>
<code> [43]  :EndIf</code>
<code> [44]  line←('''',version,'''')⎕R('''',version2,'''')⊣line</code>
<code> [45]  (row⊃body)←line</code>
<code> [46]  :If flag</code>
<code> [47]      ref.##.⎕FIX body</code>
<code> [48]  :Else</code>
<code> [49]      ref.⎕FX body</code>
<code> [50]  :EndIf</code>
<code> [51] ⍝Done</code>
</div>
<code class="header" id="listing_13">#.MakeHelpers.MakeHelpers.AddBuildIDtoVersionSimple &mdash; 85%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {body}←x AddBuildIDtoVersionSimple buildID</code>
<code> [1]   ⍝ `x` can either be a reference pointing to a class, an Interface or a scripted namespace</code>
<code> [2]   ⍝ or the name of a function in an ordinary namespace.\\</code>
<code> [3]   ⍝ Generally `AddBuildIDtoVersionSimple` executes the `Version` function (⍺) if there is</code>
<code> [4]   ⍝ any. It then either adds the build ID (⍵, an integer) if there was not any yet</code>
<code> [5]   ⍝ or replaces it by the built ID given.</code>
<code> [6]   :If ¯1≡×⎕NC⊂⍕x                                  ⍝ Member of a class?</code>
<code> [7]   :OrIf {0::0 ⋄ 1⊣⎕SRC⍎⍵}¯1↓1⊃'.'A.SplitPath x    ⍝ Function in a scripted namespace?</code>
<code> [8]       x←⍎⊃{⍺,'.',⍵}/¯1↓'.'(≠⊆⊢)x</code>
<code> [9]   :EndIf</code>
<code> [10]  :If flag←0=≡x</code>
<code> [11]      body←⎕SRC ref←x</code>
<code> [12]      result←ref.Version</code>
<code> [13]      :If 0=≢buff←'∇ *[A-Za-z]←Version'⎕S 0 1 2⍠('Mode' 'L')('Greedy' 0)('IC' 1)⊣body</code>
<code class="emphasize">→[14]          'Could not find function `Version`'⎕SIGNAL 6</code>
<code> [15]      :EndIf</code>
<code> [16]      (offset length row)←⊃buff   ⍝ There might be other `Version` functions but the first one is "ours"</code>
<code> [17]      varsName←{{⍵↑⍨¯1+⍵⍳'←'}' '~⍨⍵↓⍨⍵⍳'∇'}(row+1)⊃body</code>
<code> [18]      row+←2+⊃('\b',varsName,'←')⎕S 2⊣(1+row)↓body</code>
<code> [19]      version←{⍵↑⍨¯1+⍵⍳''''}{{⌽⍵/⍨2&gt;+\''''=⍵}⌽⍵}row⊃body</code>
<code> [20]  :Else</code>
<code> [21]      ref←⍎¯1↓⊃'.'A.SplitPath fnsname←x</code>
<code> [22]      body←⎕NR fnsname</code>
<code> [23]      version←⍎fnsname</code>
<code> [24]      row←⊃¯1↑⍸∨/¨version∘⍷¨body</code>
<code> [25]  :EndIf</code>
<code> [26]  :If 2='.'+.=version</code>
<code> [27]      :If '+'∊version</code>
<code> [28]          version2←(version↑⍨version⍳'+'),⍕buildID</code>
<code> [29]      :Else</code>
<code> [30]          version2←version,'+',⍕buildID</code>
<code> [31]      :EndIf</code>
<code> [32]  :Else</code>
<code class="emphasize">→[33]      :If 2&lt;'.'+.=version</code>
<code class="emphasize">→[34]          version[3⊃⍸'.'=version]←'+'</code>
<code> [35]      :EndIf</code>
<code class="emphasize">→[36]      version2←({⍵↑⍨¯1+⍵⍳'+'}version),'+',⍕buildID</code>
<code> [37]  :EndIf</code>
<code> [38]  version←⊃,/(⊂'\.')@(⍸'.'=version)⊣version</code>
<code> [39]  version←⊃,/(⊂'\+')@(⍸'+'=version)⊣version</code>
<code> [40]  line←row⊃body</code>
<code> [41]  :If 2&lt;'.'+.=line</code>
<code class="emphasize">→[42]      line[3⊃⍸'.'=line]←'+'</code>
<code> [43]  :EndIf</code>
<code> [44]  line←('''',version,'''')⎕R('''',version2,'''')⊣line</code>
<code> [45]  (row⊃body)←line</code>
<code> [46]  :If flag</code>
<code> [47]      ref.##.⎕FIX body</code>
<code> [48]  :Else</code>
<code> [49]      ref.⎕FX body</code>
<code> [50]  :EndIf</code>
<code> [51] ⍝Done</code>
</div>
<code class="header" id="listing_14">#.MakeHelpers.MakeHelpers.CreateAPI &mdash; 86%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>   {r}←{savePath}CreateAPI y</code>
<code> [1]   ⍝ Deletes and then re-creates a namespace `API_Name` within `refTosourceNS` and then establishes cover fns/opr</code>
<code> [2]   ⍝ or references (variables) etc serving as API (public interface).\\</code>
<code> [3]   ⍝ If you wish you may specify `API_name` as a fully qualified name which is useful mostly for test cases.</code>
<code> [4]   ⍝ If you don't then it is assumed to live inside `refTosourceNS`.\\</code>
<code> [5]   ⍝ `⍵` must be a vector of length 2 or 3:\\</code>
<code> [6]   ⍝ [1] (`refTosourceNS`, mandatory) name of the source namespace\\</code>
<code> [7]   ⍝ [2] (`names`, mandatory) list of all public names, typically returned by a function named "Public" or the like\\</code>
<code> [8]   ⍝ [3] (`API_name`, optional): the name of the target namespace; defaults to "API"\\</code>
<code> [9]   ⍝ By default Link is told about the functions (but not refs) created.</code>
<code> [10]  ⍝ Instead you may specify a folder via `⍺` which must exist.</code>
<code> [11]  ⍝ If you do then all fns/opr are saved within that folder without involving Link.</code>
<code> [12]  ⍝ If you don't want anything to be saved on disk at all then specify `''` as `⍺`.\\</code>
<code> [13]  ⍝ Returns the number of fns/opr and refs established.\\</code>
<code> [14]  ⍝ Handles all kinds of objects: niladic, monadic, dyadic and ambivalent fns as well as</code>
<code> [15]  ⍝ monadic and dyadic operators and scripted namespaces, classes, interfaces and variables.</code>
<code> [16]  ⍝ It also honors shy results.\\</code>
<code> [17]   r←0</code>
<code> [18]   (refTosourceNS names API_name)←3↑y,⊂'API'</code>
<code> [19]   'Source namespace (1⊃⍵) is not a reference'Assert 0 1≡{(≡⍵)(≢⍵)}refTosourceNS</code>
<code> [20]   'Source namespace (1⊃⍵) is not a namespace'Assert 0=+/'[]'∊refTosourceNS</code>
<code> [21]   'Source namespace (1⊃⍵) is not a namespace'Assert 9.1≡⎕NC⊂⍕refTosourceNS</code>
<code> [22]   savePath←{0&lt;⎕NC ⍵:⍎⍵ ⋄ ¯1}'savePath'</code>
<code> [23]   'No API names specified?!'Assert 0&lt;≢names</code>
<code> [24]   names←⊆names</code>
<code> [25]   API_name←⍕{0&lt;⎕NC ⍵:⍎⍵ ⋄ 'API'}'API_name'</code>
<code> [26]   :If (⊃API_name)∊'#⎕'</code>
<code> [27]       targetNamespace←API_name</code>
<code> [28]   :Else</code>
<code> [29]       targetNamespace←(⍕refTosourceNS),'.',API_name</code>
<code> [30]   :EndIf</code>
<code> [31]   :If 0&lt;⎕NC targetNamespace</code>
<code> [32]       :If 0&lt;≢(⍎targetNamespace).⎕NL⍳16</code>
<code> [33]           :Trap 0</code>
<code> [34]               {}⎕SE.Link.Expunge targetNamespace</code>
<code> [35]               ⎕DL 0.05</code>
<code> [36]           :Else</code>
<code class="emphasize">→[37]               {}⎕SE.Link.Expunge targetNamespace</code>
<code class="emphasize">→[38]               ⎕DL 0.05</code>
<code> [39]           :EndTrap</code>
<code> [40]       :EndIf</code>
<code> [41]   :EndIf</code>
<code> [42]   Tref←⍎targetNamespace ⎕NS''</code>
<code> [43]   :If ¯1≢savePath</code>
<code class="emphasize">→[44]   :AndIf 0&lt;≢savePath</code>
<code class="emphasize">→[45]       'Create!'F.CheckPath savePath</code>
<code> [46]   :EndIf</code>
<code> [47]   :If ∨/b←0=refTosourceNS.⎕NC↑names</code>
<code class="emphasize">→[48]       0 Assert⍨'Not found in ',(⍕refTosourceNS),': ',⊃{⍺,', ',⍵}/b/names</code>
<code> [49]   :EndIf</code>
<code> [50]   :For name :In names</code>
<code> [51]       name~←' '</code>
<code> [52]       :Select level←'.'+.=name</code>
<code> [53]       :Case 0</code>
<code> [54]           subNamespace←''</code>
<code> [55]       :Case 1</code>
<code> [56]           subNamespace←{⍵↑⍨¯1+⍵⍳'.'}name</code>
<code> [57]           :If 0=Tref.⎕NC subNamespace</code>
<code> [58]               subNamespace Tref.⎕NS''</code>
<code> [59]           :EndIf</code>
<code> [60]       :Else</code>
<code class="emphasize">→[61]           'API must not contain namespaces more than level deep'Assert 0</code>
<code> [62]       :EndSelect</code>
<code> [63]       flag←1</code>
<code> [64]       type←refTosourceNS.⎕NC⊂name</code>
<code> [65]       backRef←⊃,/(level+1)⍴⊂'##.'</code>
<code> [66]       :If 3=⌊type        ⍝ Function?</code>
<code> [67]           r+←1</code>
<code> [68]           at←refTosourceNS.⎕AT name</code>
<code> [69]           header←1⊃refTosourceNS.⎕NR name</code>
<code> [70]           :If 0=1 2⊃at   ⍝ Niladic functions need special treatment</code>
<code> [71]               backRef,←{0=≢⍵:⍵ ⋄ ⍵,'.'}subNamespace</code>
<code> [72]               header←{⍵↑⍨¯1+⌊/⍵⍳'⍝;'}header</code>
<code> [73]               :If 0=≢subNamespace</code>
<code> [74]                   :If '←'∊header  ⍝ With result</code>
<code> [75]                       Tref.⎕FX header({('{}'~⍨1⊃⍵),'←',backRef,(2⊃⍵)}'←'A.Split{⍵↑⍨¯1+⍵⍳'⍝'}header)</code>
<code> [76]                   :Else           ⍝ Without result</code>
<code> [77]                       Tref.⎕FX header({backRef,⍵}{⍵↑⍨¯1+⍵⍳'⍝'}header)</code>
<code> [78]                   :EndIf</code>
<code> [79]               :Else</code>
<code> [80]                   (Tref⍎subNamespace).⎕FX header({(1⊃⍵),'←',backRef,(2⊃⍵)}'←'A.Split{⍵↑⍨¯1+⍵⍳'⍝'}header)</code>
<code> [81]               :EndIf</code>
<code> [82]           :Else</code>
<code> [83]               :If 2=|1 2⊃at</code>
<code> [84]                   :If '{'=⊃A.DLB header</code>
<code> [85]                       backRef Tref.{⍎⍵,'←{⍺←⊢ ⋄ 1:shy←⍺ ',⍺,⍵,' ⍵}'}name</code>
<code> [86]                   :Else</code>
<code> [87]                       backRef Tref.{⍎⍵,'←{⍺←⊢ ⋄ ⍺ ',⍺,⍵,' ⍵}'}name</code>
<code> [88]                   :EndIf</code>
<code> [89]               :Else</code>
<code> [90]                   :If '{'=⊃A.DLB header</code>
<code> [91]                       backRef Tref.{⍎⍵,'←{1:shy←',⍺,⍵,' ⍵}'}name</code>
<code> [92]                   :Else</code>
<code> [93]                       backRef Tref.{⍎⍵,'←{',⍺,⍵,' ⍵}'}name</code>
<code> [94]                   :EndIf</code>
<code> [95]               :EndIf</code>
<code> [96]           :EndIf</code>
<code> [97]       :ElseIf 4=⌊type     ⍝ Operator</code>
<code> [98]           :Select 12 refTosourceNS.⎕ATX name  ⍝ Syntax</code>
<code> [99]           :Case 1 ⍝ monadic operator</code>
<code> [100]              backRef Tref.{⍎⍵,'←{⍺←⊢ ⋄ 1:shy←⍺ (⍺⍺ ',⍺,⍵,') ⍵}'}name</code>
<code> [101]          :Case 2 ⍝ monadic operator</code>
<code> [102]              backRef Tref.{⍎⍵,'←{⍺←⊢ ⋄ 1:shy←⍺ (⍺⍺ ',⍺,⍵,' ⍵⍵) ⍵}'}name</code>
<code> [103]          :Else</code>
<code class="emphasize">→[104]              'An operator that is neither monadic nor dyadic?!'⎕SIGNAL 11</code>
<code> [105]          :EndSelect</code>
<code> [106]          r+←1</code>
<code> [107]      :ElseIf 2=⌊type     ⍝ Variable</code>
<code> [108]          backRef Tref.{⍎'⎕THIS.',⍵,'←',⍺,⍵}name</code>
<code> [109]          r+←1</code>
<code> [110]          extension←'apla'</code>
<code> [111]      :ElseIf 9.1=type   ⍝ Namespace script?</code>
<code> [112]          backRef Tref.{⍎'⎕THIS.',⍵,'←',⍺,⍵}name</code>
<code> [113]          r+←1</code>
<code> [114]          extension←'apln'</code>
<code> [115]      :ElseIf 9.4=type   ⍝ Class?</code>
<code> [116]          backRef Tref.{⍎'⎕THIS.',⍵,'←',⍺,⍵}name</code>
<code> [117]          r+←1</code>
<code> [118]          extension←'aplc'</code>
<code> [119]      :ElseIf 9.5=type   ⍝ Interface?</code>
<code> [120]          backRef Tref.{⍎'⎕THIS.',⍵,'←',⍺,⍵}name</code>
<code> [121]          r+←1</code>
<code> [122]          extension←'apli'</code>
<code> [123]      :Else</code>
<code class="emphasize">→[124]          ⎕←'*** Ignored: ',name,' (name class=',(⍕type),')'</code>
<code class="emphasize">→[125]          flag←0</code>
<code> [126]      :EndIf</code>
<code> [127]      :If flag</code>
<code> [128]      :AndIf (⌊type)∊2 3 4</code>
<code> [129]          :If ¯1≡savePath</code>
<code> [130]              fullName←(⍕Tref),'.',name</code>
<code> [131]              ⎕DL 0.05</code>
<code> [132]              {}⎕SE.Link.Add fullName</code>
<code> [133]          :ElseIf 0&lt;≢savePath</code>
<code class="emphasize">→[134]              extension←'aplf'</code>
<code class="emphasize">→[135]              filename←name,'.',extension</code>
<code class="emphasize">→[136]              body←Tref.⎕NR name</code>
<code class="emphasize">→[137]              (⊂body)⎕NPUT(savePath,'/',filename)1</code>
<code> [138]          :Else</code>
<code> [139]              ⍝ User does not want to save anything.</code>
<code> [140]          :EndIf</code>
<code> [141]      :EndIf</code>
<code> [142]  :EndFor</code>
<code> [143] ⍝Done</code>
</div>
<code class="header" id="listing_15">#.MakeHelpers.MakeHelpers.CompileVersionNumberPattern &mdash; 87%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  newVersion←{force}CompileVersionNumberPattern y</code>
<code> [1]  ⍝ Establishes the current version of a Tatin package from the right argument and then asks the user</code>
<code> [2]  ⍝ whether she wants to bump any part of the version number, or none at all.\\</code>
<code> [3]  ⍝ The right argument must be one of:</code>
<code> [4]  ⍝ * A package config file (`cfg`), in which case `cfg.version` rules what the current version is</code>
<code> [5]  ⍝ * A two-item vector:</code>
<code> [6]  ⍝   1. Version (like "1.2.3" or "10.22.3-beta-1+123"), usually returned by a "Version" function</code>
<code> [7]  ⍝   2. Name of the project\\</code>
<code> [8]  ⍝ That defines what is used for communicating with the user.\\</code>
<code> [9]  ⍝ Note that the user by default has no option to cancel the operation because the optional left argument</code>
<code> [10] ⍝ `force` defaults to 1. If you specify a 0 as `⍺` then the user may cancel, and `newVersion←⎕NULL`.</code>
<code> [11]  force←{0&lt;⎕NC ⍵:⍎⍵ ⋄ 1}'force'</code>
<code> [12]  'Left argument must be a Boolean'Assert(⊂force)∊0 1</code>
<code> [13]  'Right argument must have a length of 1 (pkg cfg) or 2 (version and name)'Assert(≢y)∊1 2</code>
<code> [14]  :If 1=≢y</code>
<code> [15]      cfg←y                                  ⍝ It must be a package configuration namespace</code>
<code> [16]      version←cfg.version</code>
<code> [17]      project←⊃{⍺,'-',⍵}/cfg.(group name)</code>
<code> [18]  :Else</code>
<code class="emphasize">→[19]      (version project)←y</code>
<code> [20]  :EndIf</code>
<code> [21]  currentVersion←DropBuildNumber version</code>
<code> [22]  caption←'Bump version of ',project,' (currently on ',version,')'</code>
<code> [23]  options←'Don''t change' 'Bump patch number' 'Bump minor number' 'Bump major number',(~force)/⊂'Cancel operation'</code>
<code> [24]  choice←caption 0 1 Select options</code>
<code> [25]  :If choice=5</code>
<code class="emphasize">→[26]      newVersion←⎕NULL</code>
<code> [27]  :Else</code>
<code> [28]      newVersion←choice⊃'' '+0.0.1' '+0.1.0' '+1.0.0'</code>
<code> [29]  :EndIf</code>
<code> [30] ⍝Done</code>
</div>
<code class="header" id="listing_16">#.MakeHelpers.MakeHelpers.RecreateFolder &mdash; 88%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←{levels}RecreateFolder targetFolder</code>
<code> [1]  ⍝ Typically the right argument is `./Dist`. The folder will be removed and then created.\\</code>
<code> [2]  ⍝ `levels` defaults to 1, meaning that only the very last level of the path is removed.\\</code>
<code> [3]  ⍝ Tries a maximum of 4 times with a delay in between when an error occurs.</code>
<code> [4]  ⍝ The loop was introduced because on some systems the first attempt often, the second attempt</code>
<code> [5]  ⍝ sometimes failed, but finally it would succeed.</code>
<code> [6]   r←⍬</code>
<code> [7]   targetFolder←F.NormalizePath targetFolder</code>
<code> [8]   levels←¯1+{0&lt;⎕NC ⍵:⍎⍵ ⋄ 1}'levels'</code>
<code> [9]   targetFolder2←F.CurrentSep{1↓⊃,/⍺,¨⍵}(-levels)↓F.CurrentSep A.Split targetFolder</code>
<code> [10]  :If F.IsDir targetFolder2</code>
<code> [11]      max←4</code>
<code> [12]      counter←flag←0</code>
<code> [13]      :Repeat</code>
<code> [14]          counter+←1</code>
<code> [15]          (rc more)←F.RmDirByForce targetFolder2</code>
<code> [16]          :If rc=0</code>
<code> [17]              flag←1</code>
<code> [18]          :Else</code>
<code class="emphasize">→[19]              ⎕DL 0.25</code>
<code> [20]          :EndIf</code>
<code> [21]      :Until flag∨max=counter</code>
<code> [22]      :If ~flag</code>
<code class="emphasize">→[23]          (more,'; rc= ',⍕rc)Assert 0</code>
<code> [24]      :EndIf</code>
<code> [25]  :EndIf</code>
<code> [26]  'Could not create the target folder'Assert'Create!'F.CheckPath targetFolder</code>
<code> [27] ⍝Done</code>
</div>
<code class="header" id="listing_17">#.MakeHelpers.MakeHelpers.RemoveStuffButSetupExe &mdash; 89%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←RemoveStuffButSetupExe folder</code>
<code> [1]  ⍝ Use this to remove everything from `folder/` but a file with a name that starts with "Setup" and has the extension ".exe".\\</code>
<code> [2]  ⍝ Does not worry about case sensitivity because this is Windows-only in any case.</code>
<code> [3]   r←⍬</code>
<code> [4]   list←⊃('recursive' 1)F.Dir folder,'/'</code>
<code> [5]   :If 0&lt;≢ind←(⍳≢list)~1+'^setUp.*\.exe$'⎕S 2⍠('Greedy' 0)('IC' 1)⊣{⊃,/1↓⎕NPARTS ⍵}¨list</code>
<code> [6]       list←list[ind]</code>
<code> [7]       :If 0&lt;+/isFile←F.IsFile list</code>
<code> [8]           F.DeleteFile isFile/list</code>
<code> [9]       :EndIf</code>
<code> [10]      isDir←~isFile</code>
<code> [11]      :If 0&lt;+/isDir</code>
<code class="emphasize">→[12]          {}F.RmDirByForce isDir/list</code>
<code> [13]      :EndIf</code>
<code> [14]  :EndIf</code>
<code> [15] ⍝Done</code>
</div>
<code class="header" id="listing_18">#.MakeHelpers.MakeHelpers.CreateAPIfromCFG &mdash; 91%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←{savePath}CreateAPIfromCFG(refToSourceNS cfg)</code>
<code> [1]  ⍝ Creates an API according to the config file. No checks are performed, so you must not call this functions in case</code>
<code> [2]  ⍝ you don't want the API to be (re)-created automatically.\\</code>
<code> [3]  ⍝ Established either all functions and operators in the API or, if there is a function `Public`, only those noted by it.\\</code>
<code> [4]  ⍝ The API is always created within `refToSourceNS`.\\</code>
<code> [5]  ⍝ `⍵` must be a vector of length 2:\\</code>
<code> [6]  ⍝ 1. `refToSourceNS`: ref to the source namespace</code>
<code> [7]  ⍝ 2. `cfg`: the package config file in JSON5 format\\</code>
<code> [8]  ⍝ Note that `Public` might not only list fns and ops but also classes, interfaces and namespace scripts</code>
<code> [9]  ⍝ By default Link is told about the functions (but not refs) created.</code>
<code> [10] ⍝ Instead you may specify a folder via `⍺` which must exist.</code>
<code> [11] ⍝ If you do then all fns/opr are saved within that folder without involving Link.</code>
<code> [12] ⍝ If you don't want anything to be saved on disk at all then specify `''` as `⍺`.\\</code>
<code> [13] ⍝ Returns the number of fns/opr and refs established.\\</code>
<code> [14]  r←0</code>
<code> [15]  'Source namespace (1⊃⍵) is not a reference'Assert 0 1≡{(≡⍵)(≢⍵)}refToSourceNS</code>
<code> [16]  'Source namespace (1⊃⍵) is not a namespace'Assert 0=+/'[]'∊refToSourceNS</code>
<code> [17]  'Source namespace (1⊃⍵) is not a namespace'Assert 9.1≡⎕NC⊂⍕refToSourceNS</code>
<code> [18]  savePath←{0&lt;⎕NC ⍵:⍎⍵ ⋄ ¯1}'savePath'</code>
<code> [19]  :If 3=refToSourceNS.⎕NC'Public'</code>
<code> [20]      names←refToSourceNS⍎'Public'           ⍝ A function `Public` rules if it exists</code>
<code> [21]  :Else</code>
<code class="emphasize">→[22]      names←' '~⍨¨↓refToSourceNS.⎕NL 3 4     ⍝ Default: the names of all fns and ops</code>
<code> [23]  :EndIf</code>
<code> [24]  'No API names specified?!'Assert 0&lt;≢names</code>
<code> [25]  targetNamespace←(⍕refToSourceNS),'.',cfg.api</code>
<code> [26]  r←CreateAPI refToSourceNS names targetNamespace</code>
<code> [27] ⍝Done</code>
</div>
<code class="header" id="listing_19">#.MakeHelpers.MakeHelpers.CreateStandAloneExeParms &mdash; 91%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←CreateStandAloneExeParms(Filename ProjectName)</code>
<code> [1]  ⍝ Creates a parameter space for the `MakeStandAloneRunTimeExe` function.\\</code>
<code> [2]  ⍝ This is a Windows-only helper.\\</code>
<code> [3]  ⍝ `⍵` is a two-element vector:</code>
<code> [4]  ⍝ 1. The filename of the EXE to be created.</code>
<code> [5]  ⍝ 2. Name of the project. For "Fire" that would be "Fire"\\</code>
<code> [6]  ⍝ Workflow:\\</code>
<code> [7]  ⍝ 1. Create parameter space</code>
<code> [8]  ⍝ 1. Make amendments</code>
<code> [9]  ⍝ 1. Call `MakeStandAloneRunTimeExe` and pass the parameter space as right argument</code>
<code> [10]  r←⎕NS''</code>
<code> [11]  r.(Filename ProjectName)←Filename ProjectName</code>
<code> [12]  r.Filename←⎕NPARTS r.Filename</code>
<code> [13]  :If 0=≢2⊃r.Filename</code>
<code class="emphasize">→[14]      (2⊃r.Filename)←ProjectName</code>
<code> [15]  :EndIf</code>
<code> [16]  (3⊃r.Filename)←'.exe'</code>
<code> [17]  r.Filename←⊃,/r.Filename</code>
<code> [18]  r.Icon←''</code>
<code> [19]  r.CompanyName←'YourCompany'</code>
<code> [20]  r.LegalCopyright←'See https://github.com/aplteam/',r.ProjectName</code>
<code> [21]  r.ProductName←r.ProjectName</code>
<code> [22]  :If 0&lt;(⍎'#.',r.ProjectName).⎕NC'Version'</code>
<code> [23]      r.FileVersion←{1=≡⍵:⍵ ⋄ 2⊃⍵}#.⍎r.ProjectName,'.Version'  ⍝ Backwards compatability</code>
<code> [24]  :Else</code>
<code class="emphasize">→[25]      r.FileVersion←''</code>
<code> [26]  :EndIf</code>
<code> [27]  r.FileDescription←''</code>
<code> [28]  r.ProductVersion←2⊃#.⍎r.ProjectName,'.Version'</code>
<code> [29]  r.CompanyName←'YourCompany'        ⍝ Not shown by Windows Explorer anyway</code>
<code> [30]  r.Comments←''                      ⍝ Not shown by Windows Explorer anyway</code>
<code> [31]  r.Commandline←''                   ⍝ Any commandline parameters to be passed on</code>
<code> [32]  r.Resource←''</code>
<code> [33]  r.RunTime←1                        ⍝ Set this to 1 only when you need to debug the EXE.</code>
<code> [34]  Assert' '=1↑0⍴r.⎕FX'r←∆List' 'r←{⍵,[1.5]⍎¨⍵}'' ''~⍨¨↓⎕nl 2'</code>
<code> [35] ⍝Done</code>
</div>
<code class="header" id="listing_20">#.MakeHelpers.MakeHelpers.CreateZipFile &mdash; 92%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {zipFilename}←CreateZipFile(name folder version)</code>
<code> [1]  ⍝ Everything in `folder\` goes into `&lt;name&gt;.zip`.\\</code>
<code> [2]  ⍝ `version` should be a simple text string with something like `'1.2.3'` or `'1.2.3'` or `'1.2.3-beta-1'`\\</code>
<code> [3]  ⍝ In case `version` carries a build number it will be removed.\\</code>
<code> [4]  ⍝ If you don't want a version number to be added at all then just pass an empty vector.\\</code>
<code> [5]   zipFilename←name</code>
<code> [6]   :If 2=≡version</code>
<code class="emphasize">→[7]       version←2⊃version</code>
<code> [8]   :EndIf</code>
<code> [9]   :If 0&lt;≢version</code>
<code> [10]      'Version number must be simple text'Assert 1=≡version</code>
<code> [11]      'Version number must be simple text'Assert' '=1↑0⍴∊version</code>
<code> [12]      'Version number must carry two dots'Assert('.'+.=version)∊2 3  ⍝ 3 for (deprecated) build numbers</code>
<code> [13]      zipFilename←name,'-',DropBuildNumber version</code>
<code> [14]  :EndIf</code>
<code> [15]  zipFilename,←{'.zip'/⍨'.zip'≢⎕C ¯4↑⍵}zipFilename</code>
<code> [16]  1 ⎕NDELETE folder,'/',zipFilename</code>
<code> [17]  zipFilename←folder,'/',zipFilename</code>
<code> [18]  1 ⎕NDELETE zipFilename</code>
<code> [19]  {}folder ZipArchive.ZipFolder zipFilename  ⍝##⍝</code>
<code> [20] ⍝Done</code>
</div>
<code class="header" id="listing_21">#.MakeHelpers.MakeHelpers.IncreaseBuildIDInFunction &mdash; 96%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {version}←{isTest}IncreaseBuildIDInFunction fnsName</code>
<code> [1]  ⍝ Increases the build number of `fnsName` which must be the fully qualified name of a "Version" function</code>
<code> [2]  ⍝ that lives either as a public method in a class or a trad-function in a namespace or namespace script.\\</code>
<code> [3]  ⍝ The build number is increased by 1, the modified script or function fixed and Link is notified.\\</code>
<code> [4]  ⍝ Returns the new version string as simple character vector or ''.\\</code>
<code> [5]  ⍝ The version function may return one of:</code>
<code> [6]  ⍝ * A simple character vector with the version number</code>
<code> [7]  ⍝ * A nested vector of length two: version number and version date like '1.2.3' '2023-03-01'</code>
<code> [8]  ⍝ * A nested vector of length three: name, version number and version date\\</code>
<code> [9]  ⍝ The left argument is used only by test cases.</code>
<code> [10]  version←''</code>
<code> [11]  isTest←{0=⎕NC ⍵:0 ⋄ ⍎⍵}'isTest'</code>
<code> [12]  :If 0&lt;⎕NC⊂fnsName</code>
<code> [13]      name←'.'A.Last fnsName</code>
<code> [14]  :OrIf 0≠(⍎(¯1+-≢name)↓fnsName).⎕NC⊂name  ⍝ shared method?</code>
<code> [15]      ('Is not a tradFns: ',fnsName)Assert 3.1=|⎕NC⊂fnsName</code>
<code> [16]      :If 2=≡buff←⍎fnsName</code>
<code> [17]          version←(1+3=≢buff)⊃buff</code>
<code> [18]          :If '+'∊version</code>
<code> [19]              buildID←1+A.ToNum 2⊃'+'(≠⊆⊢)version</code>
<code> [20]          :Else</code>
<code> [21]              '"version" must carry precisely two dots'Assert 2='.'+.=version</code>
<code> [22]              buildID←'1'</code>
<code> [23]          :EndIf</code>
<code> [24]          version←fnsName AddBuildIDtoVersionNested buildID</code>
<code> [25]      :Else</code>
<code> [26]          ⍝ Supposed to be a simple character string like '1.2.3' or '1.2.3+456' 'or '1.2.3-beta-4+5678'</code>
<code> [27]          version←buff</code>
<code> [28]          '"version" must carry precisely two dots'Assert 2='.'+.=version</code>
<code> [29]          :If '+'∊version</code>
<code> [30]              buildID←1+A.ToNum{⍵↓⍨⍵⍳'+'}version</code>
<code> [31]          :Else</code>
<code> [32]              buildID←'1'</code>
<code> [33]          :EndIf</code>
<code> [34]          version←fnsName AddBuildIDtoVersionSimple buildID</code>
<code> [35]      :EndIf</code>
<code> [36]      :If ~isTest</code>
<code> [37]          :If ¯1=×⎕NC⊂fnsName ⍝ Member of a class?</code>
<code> [38]          :OrIf {0::0 ⋄ 1⊣⎕SRC⍎⍵}¯1↓1⊃'.'A.SplitPath fnsName</code>
<code class="emphasize">→[39]              {}⎕SE.Link.Add ¯1↓1⊃'.'A.SplitPath fnsName</code>
<code> [40]          :Else</code>
<code> [41]              {}⎕SE.Link.Add⍕fnsName</code>
<code> [42]          :EndIf</code>
<code> [43]      :EndIf</code>
<code> [44]  :EndIf</code>
<code> [45] ⍝Done</code>
</div>
<code class="header" id="listing_22">#.MakeHelpers.MakeHelpers.Assert &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> Assert←{⎕IO←1 ⋄ ⎕ML←1 ⋄ ⍺←'' ⋄ (,1)≡,⍵:r←1 ⋄ ⍺ ⎕SIGNAL 1↓(⊃∊⍵),11}</code>
</div>
<code class="header" id="listing_23">#.MakeHelpers.MakeHelpers.Box &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  Box←{⍺←⊢</code>
<code> [1]  ⍝ box frame</code>
<code> [2]  ⍝ [⍺] char(s) to be replaced - dflt '⌹'</code>
<code> [3]  ⍝  ⍵  char array</code>
<code> [4]  ⍝  ←  array with ⍺ replaced by boxing chars</code>
<code> [5]  ⍝ ┌───┬───┬───┬───┬───┬───┬───┬───┐  ┌───┬───┬───┬───┬───┬───┬───┬───┐</code>
<code> [6]  ⍝ │   │ ∘ │   │ ∘ │   │ ∘ │   │ ∘ │  │   │ │ │   │ │ │   │ │ │   │ │ │</code>
<code> [7]  ⍝ │ ∘ │ ∘ │ ∘∘│ ∘∘│ ∘ │ ∘ │ ∘∘│ ∘∘│  │ ∘ │ │ │ ──│ └─│ │ │ │ │ ┌─│ ├─│</code>
<code> [8]  ⍝ │   │   │   │   │ ∘ │ ∘ │ ∘ │ ∘ │  │   │   │   │   │ │ │ │ │ │ │ │ │</code>
<code> [9]  ⍝ ├───┼───┼───┼───┼───┼───┼───┼───┤  ├───┼───┼───┼───┼───┼───┼───┼───┤</code>
<code> [10] ⍝ │   │ ∘ │   │ ∘ │   │ ∘ │   │ ∘ │  │   │ │ │   │ │ │   │ │ │   │ │ │</code>
<code> [11] ⍝ │∘∘ │∘∘ │∘∘∘│∘∘∘│∘∘ │∘∘ │∘∘∘│∘∘∘│  │── │─┘ │───│─┴─│─┐ │─┤ │─┬─│─┼─│</code>
<code> [12] ⍝ │   │   │   │   │ ∘ │ ∘ │ ∘ │ ∘ │  │   │   │   │   │ │ │ │ │ │ │ │ │</code>
<code> [13] ⍝ └───┴───┴───┴───┴───┴───┴───┴───┘  └───┴───┴───┴───┴───┴───┴───┴───┘</code>
<code> [14] ⍝ Phil Last 2016-02-12</code>
<code> [15]      r←⎕FMT↑⍵</code>
<code> [16]      b←r∊⍺⊣'⌹'</code>
<code> [17]      m←⍉4⊥⍉2⊥↑↑(3,/0,b,0)(3,⌿0⍪b⍪0)</code>
<code> [18]      c←'│  ─  ┌  │  │  └  ├  ─  ┐  ─  ┬  ┘  ┤  ┴  ┼ .'~' '</code>
<code> [19]      n←13 14 15 28 29 30 31 44 45 46 47 60 61 62 63</code>
<code> [20]      (⍴r)⍴(m∊n)⊖(2,⍴r)⍴r⍪(⊂n⍳m)⌷c</code>
<code> [21]  }</code>
</div>
<code class="header" id="listing_24">#.MakeHelpers.MakeHelpers.CR &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←CR</code>
<code> [1]  ⍝ Constant for Carriage Return (⎕UCS 13)</code>
<code> [2]  r←⎕UCS 13</code>
</div>
<code class="header" id="listing_25">#.MakeHelpers.MakeHelpers.ConvertMarkdownToHtml5 &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {noOf}←{cssFolder}ConvertMarkdownToHtml5(sourceFolder targetFolder)</code>
<code> [1]  ⍝ Convert all Markdown files found in `sourceFolder` into `targetFolder`.\\</code>
<code> [2]  ⍝ CSS files are picked up from `cssFolder`.\\</code>
<code> [3]  ⍝ Returns the number of Markdown files converted.</code>
<code> [4]   noOf←0</code>
<code> [5]   'Create!'F.CheckPath targetFolder</code>
<code> [6]   markdownFiles←⊃F.Dir sourceFolder,'/*.md'</code>
<code> [7]   cssFolder←{0&lt;⎕NC ⍵:⍎⍵ ⋄ MarkAPL.##.TatinVars.GetFullPath2AssetsFolder}'cssFolder'</code>
<code> [8]   parms←MarkAPL.CreateParms</code>
<code> [9]   parms.cssURL←cssFolder</code>
<code> [10]  parms.verbose←0</code>
<code> [11]  :For markdownFile :In markdownFiles</code>
<code> [12]      noOf+←1</code>
<code> [13]      parms.inputFilename←markdownFile</code>
<code> [14]      parms.outputFilename←targetFolder,'/',(2⊃⎕NPARTS markdownFile),'.html'</code>
<code> [15]      (html ns)←parms MarkAPL.Markdown2HTML''</code>
<code> [16]      (⊂html)F.NPUT(targetFolder,'/',(2⊃⎕NPARTS markdownFile),'.html')1</code>
<code> [17]  :EndFor</code>
<code> [18] ⍝Done</code>
</div>
<code class="header" id="listing_26">#.MakeHelpers.MakeHelpers.DropBuildNumber &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  version←DropBuildNumber version</code>
<code> [1]  ⍝ Takes one of:</code>
<code> [2]  ⍝ * A text vector that is a version number, possibly with a build number</code>
<code> [3]  ⍝ * A nested vector of length 2 with the version number in the first item and YYYY-MM-DD in the second</code>
<code> [4]  ⍝ * A nested vector of length 3 with name, version and date</code>
<code> [5]  ⍝ Returns what it got but without a build number</code>
<code> [6]  ⍝ Examples:</code>
<code> [7]  ⍝ * `'1.2.3' ← DropBuildNumber '1.2.3'`</code>
<code> [8]  ⍝ * `'1.2.3' ← DropBuildNumber '1.2.3+1234'`</code>
<code> [9]  ⍝ * `'1.2.3' ← DropBuildNumber '1.2.3' '2019-03-07'`</code>
<code> [10] ⍝ * `'1.2.3' ← DropBuildNumber '1.2.3+1234' '2019-03-07'`</code>
<code> [11] ⍝ * `'1.2.3' ← DropBuildNumber 'Foo' '1.2.3' '2019-03-07'`</code>
<code> [12] ⍝ * `'1.2.3' ← DropBuildNumber 'Foo' '1.2.3+1234' '2019-03-07'`</code>
<code> [13]  :If 1&lt;≡version</code>
<code> [14]      ind←1+3=≢version</code>
<code> [15]      (ind⊃version)←DropBuildNumber ind⊃version</code>
<code> [16]  :ElseIf '+'∊version</code>
<code> [17]      version←(¯1+version⍳'+')↑version</code>
<code> [18]  :EndIf</code>
<code> [19] ⍝Done</code>
</div>
<code class="header" id="listing_27">#.MakeHelpers.MakeHelpers.GetPackageCfg &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  cfg←GetPackageCfg path</code>
<code> [1]  ⍝ Returns a Tatin package config file as a namespace.\\</code>
<code> [2]  ⍝ `path` can be either a folder hosting a package config file or the full filename.</code>
<code> [3]  ⍝ If no such file can be found `⍬` is returned.\\</code>
<code> [4]  ⍝ See also `PutPackageCfg`.</code>
<code> [5]   path←F.EnforceSlash path</code>
<code> [6]   cfgFilename←path{⍺,(⍵≢(-≢⍵)↑⍺)/'/',⍵}'apl-package.json'</code>
<code> [7]   ('Config file not found: ',cfgFilename)Assert ⎕NEXISTS cfgFilename</code>
<code> [8]   json←⊃F.NGET cfgFilename</code>
<code> [9]   cfg←⎕JSON⍠('Dialect' 'JSON5')⊢json</code>
<code> [10] ⍝Done</code>
</div>
<code class="header" id="listing_28">#.MakeHelpers.MakeHelpers.GetProjectCfg &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  cfg←GetProjectCfg path</code>
<code> [1]  ⍝ Returns a Cider project config file as a namespace.\\</code>
<code> [2]  ⍝ `path` can be either a folder hosting a project or the full filename.</code>
<code> [3]  ⍝ If no such file can be found `⍬` is returned.\\</code>
<code> [4]   path←F.EnforceSlash path</code>
<code> [5]   cfgFilename←path{⍺,(⍵≢(-≢⍵)↑⍺)/'/',⍵}'cider.config'</code>
<code> [6]   ('Config file not found: ',cfgFilename)Assert ⎕NEXISTS cfgFilename</code>
<code> [7]   json←⊃F.NGET cfgFilename</code>
<code> [8]   cfg←⎕JSON⍠('Dialect' 'JSON5')⊢json</code>
<code> [9]  ⍝Done</code>
</div>
<code class="header" id="listing_29">#.MakeHelpers.MakeHelpers.Pause &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> Pause←{</code>
<code> [1]  ⍝ Cover function for `CommTools.Pause`: display a message and force the user to press &lt;enter&gt; to continue</code>
<code> [2]      ⍺←⊢</code>
<code> [3]      r←⍺ CommTools.Pause ⍵</code>
<code> [4]      1:shy←r</code>
<code> [5]  }</code>
</div>
<code class="header" id="listing_30">#.MakeHelpers.MakeHelpers.Public &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←Public</code>
<code> [1]   r←''</code>
<code> [2]   r,←⊂'CompileVersionNumberPattern'</code>
<code> [3]   r,←⊂'ConvertMarkdownToHtml5'</code>
<code> [4]   r,←⊂'CopyBetter'</code>
<code> [5]   r,←⊂'CopyTo'</code>
<code> [6]   r,←⊂'CreateAPI'</code>
<code> [7]   r,←⊂'CreateAPIfromCFG'</code>
<code> [8]   r,←⊂'CreateStandAloneExeParms'</code>
<code> [9]   r,←⊂'CreateZipFile'</code>
<code> [10]  r,←⊂'CR'</code>
<code> [11]  r,←⊂'DropBuildNumber'</code>
<code> [12]  r,←⊂'FetchLaterUserCommand'</code>
<code> [13]  r,←⊂'GetMyUCMDsFolder'</code>
<code> [14]  r,←⊂'GetPackageCfg'</code>
<code> [15]  r,←⊂'GetProjectCfg'</code>
<code> [16]  r,←⊂'GetUserHomeFolder'</code>
<code> [17]  r,←⊂'IncreaseBuildIDInFunction'</code>
<code> [18]  r,←⊂'MakeStandAloneRunTimeExe'</code>
<code> [19]  r,←⊂'Pause'</code>
<code> [20]  r,←⊂'PutPackageCfg'</code>
<code> [21]  r,←⊂'RecreateFolder'</code>
<code> [22]  r,←⊂'RemoveStuffButSetupExe'</code>
<code> [23]  r,←⊂'Select'</code>
<code> [24]  r,←⊂'SplitVersionFromBuildNumber'</code>
<code> [25]  r,←⊂'UpdateVersionNumberInInno_ISS'</code>
<code> [26]  r,←⊂'YesOrNo'</code>
<code> [27]  r,←⊂'Version'</code>
</div>
<code class="header" id="listing_31">#.MakeHelpers.MakeHelpers.PutPackageCfg &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> {r}←PutPackageCfg(path cfg)</code>
<code> [1] ⍝ Writes package configuration data (`cfg`) to a file "apl-package.json".\\</code>
<code> [2] ⍝ See also `GetPackageCfg`.</code>
<code> [3]  r←⍬</code>
<code> [4]  json←⎕JSON⍠('Dialect' 'JSON5')('Compact' 0)⊣cfg</code>
<code> [5]  (⊂json)⎕NPUT(path,'/apl-package.json')1</code>
<code> [6] ⍝Done</code>
</div>
<code class="header" id="listing_32">#.MakeHelpers.MakeHelpers.Select &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> Select←{</code>
<code> [1]  ⍝ Cover function for `CommTools.Select`: let the user choose from a number of options</code>
<code> [2]      ⍺←⊢</code>
<code> [3]      ⍺ CommTools.Select ⍵</code>
<code> [4]  }</code>
</div>
<code class="header" id="listing_33">#.MakeHelpers.MakeHelpers.SplitVersionFromBuildNumber &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  (version buildNo)←SplitVersionFromBuildNumber version</code>
<code> [1]  ⍝ Takes one of:</code>
<code> [2]  ⍝ * A text vector that is a version number, possibly with a build number</code>
<code> [3]  ⍝ * A nested vector of length 2 with the version number in the first item and YYYY-MM-DD in the second</code>
<code> [4]  ⍝ * A nested vector of length 3 with name, version and date\\</code>
<code> [5]  ⍝ Returns a nested vector of length two:\\</code>
<code> [6]  ⍝ * [1] Version number</code>
<code> [7]  ⍝ * [2] Build number, possibly empty\\</code>
<code> [8]  ⍝ Examples:</code>
<code> [9]  ⍝ * `('1.2.3' '')     ← SplitVersionFromBuildNumber '1.2.3'`</code>
<code> [10] ⍝ * `('1.2.3' '1234') ← SplitVersionFromBuildNumber '1.2.3+1234'`</code>
<code> [11] ⍝ * `('1.2.3' '')     ← SplitVersionFromBuildNumber 'Foo' '1.2.3' '2019-03-07'`</code>
<code> [12] ⍝ * `('1.2.3' '1234') ← SplitVersionFromBuildNumber 'Foo' '1.2.3+1234' '2019-03-07'`</code>
<code> [13] ⍝ * `('1.2.3' '')     ← SplitVersionFromBuildNumber '1.2.3' '2023-01-01'`</code>
<code> [14] ⍝ * `('1.2.3' '1234') ← SplitVersionFromBuildNumber '1.2.3+1234' '2023-01-01'`</code>
<code> [15] ⍝ * `('1.2.3' '')     ← SplitVersionFromBuildNumber '&lt;Name&gt;' '1.2.3' '2023-01-01'`</code>
<code> [16] ⍝ * `('1.2.3' '1234') ← SplitVersionFromBuildNumber '&lt;Name&gt;' '1.2.3+1234' '2023-01-01'`</code>
<code> [17]  :If 1&lt;≡version</code>
<code> [18]      ind←1+3=≢version</code>
<code> [19]      'More than "+" is not allowed'Assert('+'+.=ind⊃version)∊0 1</code>
<code> [20]      (version buildNo)←{'+'∊⍵:('+'≠⍵)⊆⊣⍵ ⋄ ⍵''}ind⊃version</code>
<code> [21]  :ElseIf '+'∊version</code>
<code> [22]      'More than "+" is not allowed'Assert('+'+.=version)∊0 1</code>
<code> [23]      (version buildNo)←('+'≠version)⊆⊣version</code>
<code> [24]  :Else</code>
<code> [25]      buildNo←''</code>
<code> [26]  :EndIf</code>
<code> [27] ⍝Done</code>
</div>
<code class="header" id="listing_34">#.MakeHelpers.MakeHelpers.UpdateVersionNumberInInno_ISS &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {changeFlag}←UpdateVersionNumberInInno_ISS(issFilename version)</code>
<code> [1]  ⍝ Updates `MyAppVersion` by `version` but remove any build number.\\</code>
<code> [2]  ⍝ Returns 1 in case the file was changed and 0 otherwise.</code>
<code> [3]   changeFlag←0</code>
<code> [4]   ('Inno INI file not found: ',issFilename)Assert ⎕NEXISTS issFilename</code>
<code> [5]   iss←⊃⎕NGET issFilename 1</code>
<code> [6]   item←1⍳⍨∨/¨'MyAppVersion'∘⍷¨iss</code>
<code> [7]   buff←item⊃iss</code>
<code> [8]   buff2←({⍵↑⍨⍵⍳'"'}buff),({⍵↑⍨¯1+⍵⍳'+'}version),'"'</code>
<code> [9]   :If buff≢buff2</code>
<code> [10]      (item⊃iss)←buff2</code>
<code> [11]      (⊂,iss)⎕NPUT issFilename 1</code>
<code> [12]      changeFlag←1</code>
<code> [13]  :EndIf</code>
<code> [14] ⍝Done</code>
</div>
<code class="header" id="listing_35">#.MakeHelpers.MakeHelpers.Version &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←Version</code>
<code> [1] ⍝ See also `History`</code>
<code> [2]  r←'MakeHelpers' '0.10.1-beta-1+143' '2023-08-14'</code>
</div>
<code class="header" id="listing_36">#.MakeHelpers.MakeHelpers.YesOrNo &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> YesOrNo←{</code>
<code> [1]  ⍝ Cover function for `CommTools.YesOrNo`: ask simple yes/no-questions</code>
<code> [2]      ⍺←⊢</code>
<code> [3]      ⍺ CommTools.YesOrNo ⍵</code>
<code> [4]  }</code>
</div>
<code class="header" id="listing_37">#.MakeHelpers.MakeHelpers.API.CompileVersionNumberPattern &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> CompileVersionNumberPattern←{⍺←⊢ ⋄ ⍺ ##.CompileVersionNumberPattern ⍵}</code>
</div>
<code class="header" id="listing_38">#.MakeHelpers.MakeHelpers.API.ConvertMarkdownToHtml5 &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> ConvertMarkdownToHtml5←{⍺←⊢ ⋄ 1:shy←⍺ ##.ConvertMarkdownToHtml5 ⍵}</code>
</div>
<code class="header" id="listing_39">#.MakeHelpers.MakeHelpers.API.CopyBetter &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> CopyBetter←{⍺←⊢ ⋄ 1:shy←⍺ ##.CopyBetter ⍵}</code>
</div>
<code class="header" id="listing_40">#.MakeHelpers.MakeHelpers.API.CopyTo &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> CopyTo←{⍺←⊢ ⋄ 1:shy←⍺ ##.CopyTo ⍵}</code>
</div>
<code class="header" id="listing_41">#.MakeHelpers.MakeHelpers.API.CreateAPI &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> CreateAPI←{⍺←⊢ ⋄ 1:shy←⍺ ##.CreateAPI ⍵}</code>
</div>
<code class="header" id="listing_42">#.MakeHelpers.MakeHelpers.API.CreateAPIfromCFG &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> CreateAPIfromCFG←{⍺←⊢ ⋄ 1:shy←⍺ ##.CreateAPIfromCFG ⍵}</code>
</div>
<code class="header" id="listing_43">#.MakeHelpers.MakeHelpers.API.CreateStandAloneExeParms &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> CreateStandAloneExeParms←{##.CreateStandAloneExeParms ⍵}</code>
</div>
<code class="header" id="listing_44">#.MakeHelpers.MakeHelpers.API.CreateZipFile &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> CreateZipFile←{1:shy←##.CreateZipFile ⍵}</code>
</div>
<code class="header" id="listing_45">#.MakeHelpers.MakeHelpers.API.DropBuildNumber &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> DropBuildNumber←{##.DropBuildNumber ⍵}</code>
</div>
<code class="header" id="listing_46">#.MakeHelpers.MakeHelpers.API.FetchLaterUserCommand &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> FetchLaterUserCommand←{⍺←⊢ ⋄ 1:shy←⍺ ##.FetchLaterUserCommand ⍵}</code>
</div>
<code class="header" id="listing_47">#.MakeHelpers.MakeHelpers.API.GetMyUCMDsFolder &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> GetMyUCMDsFolder←{⍺←⊢ ⋄ ⍺ ##.GetMyUCMDsFolder ⍵}</code>
</div>
<code class="header" id="listing_48">#.MakeHelpers.MakeHelpers.API.GetPackageCfg &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> GetPackageCfg←{##.GetPackageCfg ⍵}</code>
</div>
<code class="header" id="listing_49">#.MakeHelpers.MakeHelpers.API.GetProjectCfg &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> GetProjectCfg←{##.GetProjectCfg ⍵}</code>
</div>
<code class="header" id="listing_50">#.MakeHelpers.MakeHelpers.API.GetUserHomeFolder &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> GetUserHomeFolder←{⍺←⊢ ⋄ ⍺ ##.GetUserHomeFolder ⍵}</code>
</div>
<code class="header" id="listing_51">#.MakeHelpers.MakeHelpers.API.IncreaseBuildIDInFunction &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> IncreaseBuildIDInFunction←{⍺←⊢ ⋄ 1:shy←⍺ ##.IncreaseBuildIDInFunction ⍵}</code>
</div>
<code class="header" id="listing_52">#.MakeHelpers.MakeHelpers.API.MakeStandAloneRunTimeExe &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> MakeStandAloneRunTimeExe←{⍺←⊢ ⋄ 1:shy←⍺ ##.MakeStandAloneRunTimeExe ⍵}</code>
</div>
<code class="header" id="listing_53">#.MakeHelpers.MakeHelpers.API.Pause &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> Pause←{⍺←⊢ ⋄ ⍺ ##.Pause ⍵}</code>
</div>
<code class="header" id="listing_54">#.MakeHelpers.MakeHelpers.API.PutPackageCfg &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> PutPackageCfg←{1:shy←##.PutPackageCfg ⍵}</code>
</div>
<code class="header" id="listing_55">#.MakeHelpers.MakeHelpers.API.RecreateFolder &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> RecreateFolder←{⍺←⊢ ⋄ 1:shy←⍺ ##.RecreateFolder ⍵}</code>
</div>
<code class="header" id="listing_56">#.MakeHelpers.MakeHelpers.API.RemoveStuffButSetupExe &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> RemoveStuffButSetupExe←{1:shy←##.RemoveStuffButSetupExe ⍵}</code>
</div>
<code class="header" id="listing_57">#.MakeHelpers.MakeHelpers.API.Select &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> Select←{⍺←⊢ ⋄ ⍺ ##.Select ⍵}</code>
</div>
<code class="header" id="listing_58">#.MakeHelpers.MakeHelpers.API.SplitVersionFromBuildNumber &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> SplitVersionFromBuildNumber←{##.SplitVersionFromBuildNumber ⍵}</code>
</div>
<code class="header" id="listing_59">#.MakeHelpers.MakeHelpers.API.UpdateVersionNumberInInno_ISS &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> UpdateVersionNumberInInno_ISS←{1:shy←##.UpdateVersionNumberInInno_ISS ⍵}</code>
</div>
<code class="header" id="listing_60">#.MakeHelpers.MakeHelpers.API.YesOrNo &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> YesOrNo←{⍺←⊢ ⋄ ⍺ ##.YesOrNo ⍵}</code>
</div>
<div id="footer">
<hr>
<p>Created by "CodeCoverage" version 0.10.3+52 from 2023-06-23</p>
</div>

</body>
</html>
