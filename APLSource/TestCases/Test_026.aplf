 R←Test_026(stopFlag batchFlag);⎕TRAP;data;toPath;zipFilename;list
⍝ Exercise InstallUserCommand
 ⎕TRAP←(999 'C' '. ⍝ Deliberate error')(0 'N')
 R←T._Failed

 toPath←FilesAndDirs.GetTempSubDir''
 zipFilename←##.CiderConfig.HOME,'/Tests/aplteam-MakeHelpers-0.5.0.zip'
 ##.MakeHelpers.CommTools.YesOrNo_Answers←1 2⍴'Install new version as user command in' 'Y'
 →T.GoToTidyUp 0=##.MakeHelpers.InstallUserCommand zipFilename toPath
 ##.MakeHelpers.CommTools.Cleanup
 list←{⊃,/1↓⎕NPARTS ⍵}¨⊃FilesAndDirs.Dir toPath,'/'
 →T.GoToTidyUp~∧/'apl-buildlist.json' 'apl-dependencies.txt'∊list
 {}FilesAndDirs.RmDirByForce toPath

 toPath←FilesAndDirs.GetTempSubDir''
 →T.GoToTidyUp 0=1 ##.MakeHelpers.InstallUserCommand zipFilename toPath
 list←{⊃,/1↓⎕NPARTS ⍵}¨⊃FilesAndDirs.Dir toPath,'/'
 →T.GoToTidyUp~∧/'apl-buildlist.json' 'apl-dependencies.txt'∊list

 R←T._OK

∆TidyUp:
 {}FilesAndDirs.RmDirByForce toPath
 ##.MakeHelpers.CommTools.Cleanup
⍝Done
