 R←Test_022(stopFlag batchFlag);⎕TRAP;cfg;fromPath;toPath;C
⍝ Exercise CopyPackageBasics
 ⎕TRAP←(999 'C' '. ⍝ Deliberate error')(0 'N')
 R←T._Failed

 fromPath←FilesAndDirs.GetTempSubDir''
 toPath←FilesAndDirs.GetTempSubDir''
 fromPath ⎕NCOPY ##.CiderConfig.HOME,'/Tests/SomeProject/cider.config'
 C←⎕JSON⍠('Dialect' 'JSON5')⊣⊃FilesAndDirs.NGET fromPath,'/cider.config'
 C.HOME←fromPath
 cfg←⎕SE.Tatin.InitialisePackage fromPath
 cfg.(group name)←'demo' 'hello'

 →T.PassesIf 1≡##.MakeHelpers.CopyPackageBasics cfg C toPath

 'Create!'FilesAndDirs.CheckPath fromPath,'/packages'
 (fromPath,'/packages')⎕NCOPY ##.CiderConfig.HOME,'/Tests/SomeProject/apl-dependencies.txt'
 →T.PassesIf 2≡##.MakeHelpers.CopyPackageBasics cfg C toPath

 fromPath ⎕NCOPY ##.CiderConfig.HOME,'/Tests/SomeProject/LICENSE'
 →T.PassesIf 3≡##.MakeHelpers.CopyPackageBasics cfg C toPath

 R←T._OK

∆TidyUp:
 {}FilesAndDirs.RmDirByForce fromPath
 {}FilesAndDirs.RmDirByForce toPath
⍝Done
